<!DOCTYPE html>
<!-- saved from url=(0057)https://www.odoo.com/documentation/master/howtos/web.html -->
<html xmlns="http://www.w3.org/1999/xhtml" class="translated-ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="./自定义Web客户端 - odoo 12.0文档_files/css" rel="stylesheet">
  
    <title>自定义Web客户端 -  odoo 12.0文档</title>
    <link rel="stylesheet" href="./自定义Web客户端 - odoo 12.0文档_files/style.css" type="text/css">
    <link rel="stylesheet" href="./自定义Web客户端 - odoo 12.0文档_files/pygments.css" type="text/css">
    <link rel="stylesheet" href="./自定义Web客户端 - odoo 12.0文档_files/patchqueue.css" type="text/css">
    <script async="" src="./自定义Web客户端 - odoo 12.0文档_files/analytics.js.下载"></script><script type="text/javascript" src="./自定义Web客户端 - odoo 12.0文档_files/documentation_options.js.下载"></script>
    <script type="text/javascript" src="./自定义Web客户端 - odoo 12.0文档_files/jquery.js.下载"></script>
    <script type="text/javascript" src="./自定义Web客户端 - odoo 12.0文档_files/underscore.js.下载"></script>
    <script type="text/javascript" src="./自定义Web客户端 - odoo 12.0文档_files/doctools.js.下载"></script>
    <script type="text/javascript" src="./自定义Web客户端 - odoo 12.0文档_files/patchqueue.js.下载"></script>
    <script type="text/javascript" src="./自定义Web客户端 - odoo 12.0文档_files/jquery.min.js.下载"></script>
    <script type="text/javascript" src="./自定义Web客户端 - odoo 12.0文档_files/bootstrap.js.下载"></script>
    <script type="text/javascript" src="./自定义Web客户端 - odoo 12.0文档_files/doc.js.下载"></script>
    <script type="text/javascript" src="./自定义Web客户端 - odoo 12.0文档_files/jquery.noconflict.js.下载"></script>
    <link rel="index" title="指数" href="https://www.odoo.com/documentation/master/genindex.html">
    <link rel="search" title="搜索" href="https://www.odoo.com/documentation/master/search.html">
    <link rel="next" title="分析Odoo代码" href="https://www.odoo.com/documentation/master/howtos/profilecode.html">
    <link rel="prev" title="构建模块" href="https://www.odoo.com/documentation/master/howtos/backend.html"> 
  <link type="text/css" rel="stylesheet" charset="UTF-8" href="./自定义Web客户端 - odoo 12.0文档_files/translateelement.css"></head><body style="padding-bottom: 445px;"><header class="o_main_header o_has_sub_nav o_inverted">
    <div class="o_main_header_main">
      <a class="pull-left o_logo" href="https://www.odoo.com/"></a>
      <a href="https://www.odoo.com/documentation/master/howtos/web.html#" class="o_mobile_menu_toggle visible-xs-block pull-right">
        <span class="sr-only"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">切换导航</font></font></span>
        <span class="mdi-navigation-menu"></span>
      </a>
      <div class="o_header_buttons">
        <a href="http://www.odoo.com/trial" class="btn btn-primary"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在开始</font></font></a>
      </div>
      <ul class="o_primary_nav">
        <li class="dropdown">
          <a href="https://www.odoo.com/documentation/master/howtos/web.html#" class="dropdown-toggle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">应用</font></font></a>
          <div class="dropdown-menu o_secondary_nav">
            <div class="container">
              <div class="row">
                <div class="col-sm-3 o_website_apps">
                  <div class="o_nav_app_family">
                    <span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 网站
                    </font></font><div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">建立良好的用户体验</font></font></div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/website-builder"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网站建设者</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/e-commerce"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电子商务</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/blog-engine"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">博客</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/community-builder"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">论坛</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/slides"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">幻灯片</font></font></a></li>
                    <li><a href="https://adspike.odoo.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">海</font></font></a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_sale_apps">
                  <div class="o_nav_app_family">
                    <span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 销售
                    </font></font><div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">提高你的成功率</font></font></div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/sales"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">销售</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/crm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CRM</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/billing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">进销存</font></font></a></li>
                    <li class="dropdown">
                      <a href="https://www.odoo.com/documentation/master/howtos/web.html#0" class="dropdown-toggle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">销售点</font></font></a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/point-of-sale"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">商店</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/pos-restaurant"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">餐馆</font></font></a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/subscriptions"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">订阅</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/sign"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">标志</font></font></a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_operation_apps">
                  <div class="o_nav_app_family">
                    <span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 操作
                    </font></font><div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这完全取决于效率</font></font></div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/accounting"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">会计</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/project-management"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">项目</font></font></a></li>
                    <li class="dropdown">
                      <a href="https://www.odoo.com/documentation/master/howtos/web.html#0" class="dropdown-toggle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">人力资源</font></font></a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/recruitment"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">招聘</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/employees"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">雇员</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/expenses"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">花费</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/appraisal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">评价</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/fleet"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">舰队</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/leaves"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">树叶</font></font></a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/warehouse"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">库存</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/purchase"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">采购</font></font></a></li>
                    <li class="dropdown">
                      <a href="https://www.odoo.com/documentation/master/howtos/web.html#0" class="dropdown-toggle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">制造业</font></font></a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/manufacturing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">MRP</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/plm"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">PLM</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/maintenance"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">保养</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/quality"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">质量</font></font></a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="col-sm-3 o_productivity_apps">
                  <div class="o_nav_app_family">
                    <span></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 生产力工具
                    </font></font><div><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">伟大的工具=快乐的人</font></font></div>
                  </div>
                  <ul>
                    <li class="dropdown">
                      <a href="https://www.odoo.com/documentation/master/howtos/web.html#0" class="dropdown-toggle"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">通讯</font></font></a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/discuss"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">讨论</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/discuss-groups"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">邮件列表</font></font></a></li>
                        <li><a href="https://www.odoo.com/page/notes"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">笔记</font></font></a></li>
                        <li><a href="https://www.odoo.com/documentation/master/howtos/web.html#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务台</font></font></a></li>
                        <li><a href="https://www.odoo.com/documentation/master/howtos/web.html#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">约定</font></font></a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/timesheet"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">时间表</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/email-marketing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">电子邮件营销</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/events"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">活动</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/survey"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调查</font></font></a></li>
                    <li><a href="https://www.odoo.com/page/live-chat"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在线聊天</font></font></a></li>
                  </ul>
                </div>
              </div>
            </div>
            <a href="http://www.odoo.com/apps/modules" class="o_store_link"><i class="fa fa-cube fa-fw"></i><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 第三方应用</font></font></a>
          </div>
        </li>
        <li><a href="https://www.odoo.com/page/tour"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">游览</font></font></a></li>
        <li><a href="https://www.odoo.com/pricing"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">价钱</font></font></a></li>
        <li><a href="https://www.odoo.com/page/docs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件</font></font></a></li>
      </ul>
    </div>
    <nav class="navbar o_sub_nav">
      <div class="container">
        <div class="navbar-header visible-xs">
            <button type="button" class="navbar-toggle collapsed text-left btn-block" data-toggle="collapse" data-target="#o_sub-menu" aria-expanded="false"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              导航
              </font></font><span class="mdi-hardware-keyboard-arrow-down pull-right"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="o_sub-menu">
          <ol class="o_breadcrumb breadcrumb nav navbar-left">
              
              





    
        
            <li><a href="https://www.odoo.com/documentation/master/index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发人员文件</font></font></a></li>
        
    
    <li class="active"><a href="https://www.odoo.com/documentation/master/howtos/web.html#"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">自定义Web客户端</font></font></a></li>

              
          </ol>

          <div class="call-to-action navbar-right hidden-xs">
            <a href="http://www.odoo.com/trial" class="btn btn-primary"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现在开始</font></font></a>
          </div>

          <ul class="navbar-nav navbar-right nav o_sub_nav_actions">
            
              <li class="divider"></li>
            

            
            


<li class="versions dropdown">
    <a class="dropdown-toggle" href="https://www.odoo.com/documentation/master/howtos/web.html#" data-toggle="dropdown"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        12.0
    </font></font></a>
    <ul class="dropdown-menu" role="menu">
        
            <li><a href="https://www.odoo.com/documentation/8.0/howtos/web.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">8</font></font></a></li>
        
            <li><a href="https://www.odoo.com/documentation/9.0/howtos/web.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">9</font></font></a></li>
        
            <li><a href="https://www.odoo.com/documentation/10.0/howtos/web.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">10.0</font></font></a></li>
        
            <li><a href="https://www.odoo.com/documentation/11.0/howtos/web.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">11.0</font></font></a></li>
        
            <li><a href="https://www.odoo.com/documentation/master/howtos/web.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">主</font></font></a></li>
        
    </ul>
</li>

            
          </ul>

          <ul class="nav navbar-nav navbar-right">
            
              <li class="divider"></li>
            

            
            

<li><a href="https://www.odoo.com/documentation/user/12.0/index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">用户</font></font></a></li>
<li><a href="https://www.odoo.com/documentation/12.0/index.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">开发人员</font></font></a></li>
<li><a href="https://www.odoo.com/documentation/12.0/setup/install.html"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装</font></font></a></li>
<li><a href="http://training.odoo.com/courses/odoo-functional"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">培训中心</font></font></a></li>
<li><a href="https://www.odoo.com/page/odoo-white-paper"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">白皮书</font></font></a></li>
<li><a href="https://www.odoo.com/page/legal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法律</font></font></a></li>
            

            
              <li class="divider"></li>
            
          </ul>
        </div>
      </div>
    </nav>
  </header><div id="wrap" class="">
    
    
    
    <figure class="card top has_banner">
      <span class="card-img" style="background-image: url(&quot;../_static/banners/build_interface_ext.jpg&quot;); opacity: 0.35; transform: scale(1);"></span>
      <div class="container text-center" style="transform: translateY(0px); opacity: 1;">
        <h1><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> 自定义Web客户端 </font></font></h1>
      </div>
    </figure>
    
    
    
      <main class="container ">
        
        <div class="o_content row">
          
          <aside style="height: 43138px;">
            <div class="navbar-aside text-center affix-top" style="width: 239px;">
              <ul class="nav list-group text-left"><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#a-simple-module" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个简单的模块</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#odoo-javascript-module" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Odoo JavaScript模块</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#classes" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类</font></font></a></li><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#widgets-basics" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小部件基础知识</font></font></a><ul><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#your-first-widget" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">你的第一个小工具</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#display-content" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">显示内容</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#widget-parents-and-children" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小部件父母和孩子</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#destroying-widgets" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">销毁小部件</font></font></a></li></ul></li><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#the-qweb-template-engine" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QWeb模板引擎</font></font></a><ul><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#using-qweb" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用QWeb</font></font></a><ul><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#qweb-context" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QWeb上下文</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#template-declaration" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模板声明</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#escaping" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">逃离</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#outputting-html" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">输出HTML</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#conditionals" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">条件语句</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#iteration" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">迭代</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#defining-attributes" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">定义属性</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#calling-other-templates" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用其他模板</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#to-learn-more-about-qweb" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">了解有关QWeb的更多信息</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#exercise" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行使</font></font></a></li></ul></li></ul></li><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#widget-helpers" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小工具助手</font></font></a><ul><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#widget-s-jquery-selector" class="reference internal ripple" style="position: relative; overflow: hidden;"><code>Widget</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">的jQuery选择器</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#easier-dom-events-binding" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">更简单的DOM事件绑定</font></font></a></li></ul></li><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#widget-events-and-properties" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小部件事件和属性</font></font></a><ul><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#events" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">活动</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#properties" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">属性</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#id3" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行使</font></font></a></li></ul></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#modify-existing-widgets-and-classes" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修改现有的小部件和类</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#translations" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻译</font></font></a></li><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#communication-with-the-odoo-server" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与Odoo服务器通信</font></font></a><ul><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#contacting-models" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">联系模型</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#compoundcontext" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">CompoundContext</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#queries" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">查询</font></font></a></li></ul></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#exercises" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演习</font></font></a></li><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#existing-web-components" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现有的Web组件</font></font></a><ul><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#the-action-manager" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">行动经理</font></font></a><ul><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#using-the-action-manager" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">使用动作管理器</font></font></a></li></ul></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#client-actions" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">客户行动</font></font></a></li><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#architecture-of-the-views" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">观点的架构</font></font></a><ul><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#the-view-manager" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">视图管理器</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#the-views" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">观点</font></font></a></li></ul></li><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#the-form-view-fields" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表单视图字段</font></font></a><ul><li class="list-group-item parent"><a href="https://www.odoo.com/documentation/master/howtos/web.html#creating-a-new-type-of-field" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建一种新的字段</font></font></a><ul><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#simple-read-only-field" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">简单的只读字段</font></font></a></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#read-write-field" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">读写字段</font></font></a></li></ul></li></ul></li><li class="list-group-item"><a href="https://www.odoo.com/documentation/master/howtos/web.html#the-form-view-custom-widgets" class="reference internal ripple" style="position: relative; overflow: hidden;"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">表单视图自定义小组件</font></font></a></li></ul></li></ul>
              
              <p class="gith-container"><a href="https://github.com/odoo/odoo/edit/12.0/doc/howtos/web.rst" class="gith-link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
                  在GitHub上编辑
              </font></font></a></p>
              
            </div>
          </aside>
          
          <article class="doc-body ">
            
            
  <section id="customizing-the-web-client"><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意：这部分确实已经过时了。</font><font style="vertical-align: inherit;">它将在某一天更新，但同时，本教程可能会令人沮丧，因为它是很久以前写的。</font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本指南是关于为Odoo的Web客户端创建模块。</font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">要使用Odoo创建网站，请参阅</font></font><a href="https://www.odoo.com/documentation/master/howtos/website.html" class="reference internal"><span class="doc"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建网站</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> ; </font><font style="vertical-align: inherit;">要添加业务功能或扩展Odoo的现有业务系统，请参阅</font></font><a href="https://www.odoo.com/documentation/master/howtos/backend.html" class="reference internal"><span class="doc"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构建模块</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p><div role="alert" class="alert alert-warning"><h3 class="alert-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">警告</font></font></h3><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">本指南假设知识：</font></font></p><ul><li><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Javascript基础知识和良好实践</font></font></li><li><a href="http://jquery.org/" class="reference external alert-link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">jQuery的</font></font></a></li><li><a href="http://underscorejs.org/" class="reference external alert-link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Underscore.js</font></font></a></li></ul><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">它还需要</font></font><a href="https://www.odoo.com/documentation/master/setup/install.html#setup-install" class="reference internal alert-link"><span class="std-ref std"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安装Odoo</font></font></span></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">和</font></font><a href="http://git-scm.com/" class="reference external alert-link"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Git</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">。</font></font></p></div></section><section id="a-simple-module"><h2 class="o_has_permalink_marker"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个简单的模块</font></font><i class="mdi-content-link"></i></h2><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">让我们从一个简单的Odoo模块开始，该模块包含基本的Web组件配置，并让我们测试Web框架。</font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">示例模块可在线获取，可使用以下命令下载：</font></font></p><div class="highlight-console"><div class="highlight"><pre><span class="gp"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">$</font></font></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> git clone http://github.com/odoo/petstore
</font></font></pre></div>
</div>
<p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">这将</font></font><code>petstore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在您执行命令的任何位置</font><font style="vertical-align: inherit;">创建一个</font><font style="vertical-align: inherit;">文件夹。</font><font style="vertical-align: inherit;">然后，您需要将该文件夹添加到Odoo
 </font></font><a href="https://www.odoo.com/documentation/master/reference/cmdline.html#cmdoption-odoo-bin-addons-path" class="reference internal"><code class="xref std-option std">addons path</code></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">，创建一个新数据库并安装该</font></font><code>oepetstore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">模块。</font></font></p><p><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">如果您浏览该</font></font><code>petstore</code><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">文件夹，您应该看到以下内容：</font></font></p><div class="highlight-text"><div class="highlight"><pre><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">oepetstore</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|  - 图像</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">|  -  alligator.jpg</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">|  -  ball.jpg</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">|  -  crazy_circle.jpg</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">|  -  fish.jpg</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
| </font><font style="vertical-align: inherit;">` -  mice.jpg</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|  -  __init__.py</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|  -  oepetstore.message_of_the_day.csv</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|  -  __manifest__.py</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|  -  petstore_data.xml</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|  -  petstore.py</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
|  -  petstore.xml</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
` - 静态</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
    ` -  src</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        |  -  css</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        | </font><font style="vertical-align: inherit;">` -  petstore.css</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        |  -  js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        | </font><font style="vertical-align: inherit;">` -  petstore.js</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
        ` -  xml</font></font><font></font><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
            ` -  petstore.xml</font></font><font></font>
</pre></div>
</div>
<p>The module already holds various server customizations. We’ll come back to
these later, for now let’s focus on the web-related content, in the <code>static</code>
folder.</p><p>Files used in the “web” side of an Odoo module must be placed in a <code>static</code>
folder so they are available to a web browser, files outside that folder can
not be fetched by browsers. The <code>src/css</code>, <code>src/js</code> and <code>src/xml</code>
sub-folders are conventional and not strictly necessary.</p><dl><dt><code>oepetstore/static/css/petstore.css</code></dt><dd>Currently empty, will hold the <a href="http://www.w3.org/Style/CSS/Overview.en.html" class="reference external">CSS</a> for pet store content</dd><dt><code>oepetstore/static/xml/petstore.xml</code></dt><dd>Mostly empty, will hold <a href="https://www.odoo.com/documentation/master/reference/qweb.html#reference-qweb" class="reference internal"><span class="std-ref std">QWeb</span></a> templates</dd><dt><code>oepetstore/static/js/petstore.js</code></dt><dd><p>The most important (and interesting) part, contains the logic of the
application (or at least its web-browser side) as javascript. It should
currently look like:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">odoo</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"pet store home page loaded"</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">});</span><font></font>
<font></font>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span>
        <span class="s1">'petstore.homepage'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.HomePage'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</dd></dl><p>Which only prints a small message in the browser’s console.</p><p>The files in the <code>static</code> folder, need to be defined within the module in order for them to be loaded correctly. Everything in <code>src/xml</code> is defined in <code>__manifest__.py</code> while the contents of <code>src/css</code> and <code>src/js</code> are defined in <code>petstore.xml</code>, or a similar file.</p><div role="alert" class="alert alert-warning"><h3 class="alert-title">Warning</h3><p>All JavaScript files are concatenated and <a href="https://www.odoo.com/documentation/master/glossary.html#term-minified" class="reference internal alert-link"><span class="xref std-term std">minified</span></a> to improve
application load time.</p><p>One of the drawback is debugging becomes more difficult as
individual files disappear and the code is made significantly less
readable. It is possible to disable this process by enabling the
“developer mode”: log into your Odoo instance (user <em>admin</em> password
<em>admin</em> by default) open the user menu (in the top-right corner of the
Odoo screen) and select <span class="guilabel">About Odoo</span> then <span class="guilabel">Activate
the developer mode</span>:</p><img src="./自定义Web客户端 - odoo 12.0文档_files/about_odoo.png" class="img-responsive center-block"><img src="./自定义Web客户端 - odoo 12.0文档_files/devmode.png" class="img-responsive center-block"><p>This will reload the web client with optimizations disabled, making
development and debugging significantly more comfortable.</p></div></section><section id="odoo-javascript-module"><h2 class="o_has_permalink_marker">Odoo JavaScript Module<i class="mdi-content-link"></i></h2><p>Javascript doesn’t have built-in modules. As a result variables defined in
different files are all mashed together and may conflict. This has given rise
to various module patterns used to build clean namespaces and limit risks of
naming conflicts.</p><p>The Odoo framework uses one such pattern to define modules within web addons,
in order to both namespace code and correctly order its loading.</p><p><code>oepetstore/static/js/petstore.js</code> contains a module declaration:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">odoo</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">local</span><span class="p">.</span><span class="nx">xxx</span> <span class="o">=</span> <span class="p">...;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In Odoo web, modules are declared as functions set on the global <code>odoo</code>
variable. The function’s name must be the same as the addon (in this case
<code>oepetstore</code>) so the framework can find it, and automatically initialize it.</p><p>When the web client loads your module it will call the root function
and provide two parameters:</p><ul><li>the first parameter is the current instance of the Odoo web client, it gives
access to various capabilities defined by the Odoo (translations,
network services) as well as objects defined by the core or by other
modules.</li><li>the second parameter is your own local namespace automatically created by
the web client. Objects and variables which should be accessible from
outside your module (either because the Odoo web client needs to call them
or because others may want to customize them) should be set inside that
namespace.</li></ul></section><section id="classes"><h2 class="o_has_permalink_marker">Classes<i class="mdi-content-link"></i></h2><p>Much as modules, and contrary to most object-oriented languages, javascript
does not build in <em>classes</em><a href="https://www.odoo.com/documentation/master/howtos/web.html#id4" id="id1" class="footnote-ref">1</a> although it provides roughly
equivalent (if lower-level and more verbose) mechanisms.</p><p>For simplicity and developer-friendliness Odoo web provides a class
system based on John Resig’s <a href="http://ejohn.org/blog/simple-javascript-inheritance/" class="reference external">Simple JavaScript Inheritance</a>.</p><p>New classes are defined by calling the <code class="xref js-func js">extend()</code>
method of <code class="xref js js-class">odoo.web.Class()</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The <code class="xref js-func js">extend()</code> method takes a dictionary describing
the new class’s content (methods and static attributes). In this case, it will
only have a <code>say_hello</code> method which takes no parameters.</p><p>Classes are instantiated using the <code>new</code> operator:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print "hello" in the console</span>
</pre></div>
</div>
<p>And attributes of the instance can be accessed via <code>this</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span><font></font>
<font></font>
<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">();</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">"Bob"</span><span class="p">;</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print "hello Bob" in the console</span>
</pre></div>
</div>
<p>Classes can provide an initializer to perform the initial setup of the
instance, by defining an <code>init()</code> method. The initializer receives the
parameters passed when using the <code>new</code> operator:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MyClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hello"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span><font></font>
<font></font>
<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MyClass</span><span class="p">(</span><span class="s2">"Bob"</span><span class="p">);</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print "hello Bob" in the console</span>
</pre></div>
</div>
<p>It is also possible to create subclasses from existing (used-defined) classes
by calling <code class="xref js-func js">extend()</code> on the parent class, as is done
to subclass <code class="xref js js-class">Class()</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MySpanishClass</span> <span class="o">=</span> <span class="nx">MyClass</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"hola"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span><font></font>
<font></font>
<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MySpanishClass</span><span class="p">(</span><span class="s2">"Bob"</span><span class="p">);</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print "hola Bob" in the console</span>
</pre></div>
</div>
<p>When overriding a method using inheritance, you can use <code>this._super()</code> to
call the original method:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">MySpanishClass</span> <span class="o">=</span> <span class="nx">MyClass</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"translation in Spanish: hola"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span><font></font>
<font></font>
<span class="kd">var</span> <span class="nx">my_object</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">MySpanishClass</span><span class="p">(</span><span class="s2">"Bob"</span><span class="p">);</span>
<span class="nx">my_object</span><span class="p">.</span><span class="nx">say_hello</span><span class="p">();</span>
<span class="c1">// print "hello Bob \n translation in Spanish: hola Bob" in the console</span>
</pre></div>
</div>
<div role="alert" class="alert alert-warning"><h3 class="alert-title">Warning</h3><p><code>_super</code> is not a standard method, it is set on-the-fly to the next
method in the current inheritance chain, if any. It is only defined
during the <em>synchronous</em> part of a method call, for use in asynchronous
handlers (after network calls or in <code>setTimeout</code> callbacks) a reference
to its value should be retained, it should not be accessed via <code>this</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="c1">// broken, will generate an error</span>
<span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span><font></font>
<font></font>
<span class="c1">// correct</span>
<span class="nx">say_hello</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// don't forget .bind()</span>
    <span class="kd">var</span> <span class="nx">_super</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
    <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">_super</span><span class="p">();</span>
    <span class="p">}.</span><span class="nx">bind</span><span class="p">(</span><span class="k">this</span><span class="p">),</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div></section><section id="widgets-basics"><h2 class="o_has_permalink_marker">Widgets Basics<i class="mdi-content-link"></i></h2><p>The Odoo web client bundles <a href="http://jquery.org/" class="reference external">jQuery</a> for easy DOM manipulation. It is useful
and provides a better API than standard <a href="http://www.w3.org/TR/DOM-Level-3-Core/" class="reference external">W3C DOM</a><a href="https://www.odoo.com/documentation/master/howtos/web.html#dombugs" id="id2" class="footnote-ref">2</a>, but
insufficient to structure complex applications leading to difficult
maintenance.</p><p>Much like object-oriented desktop UI toolkits (e.g. <a href="http://qt-project.org/" class="reference external">Qt</a>, <a href="https://developer.apple.com/technologies/mac/cocoa.html" class="reference external">Cocoa</a> or <a href="http://www.gtk.org/" class="reference external">GTK</a>),
Odoo Web makes specific components responsible for sections of a page. In
Odoo web, the base for such components is the <code class="xref js js-class">Widget()</code>
class, a component specialized in handling a page section and displaying
information for the user.</p></section><section id="your-first-widget"><h3 class="o_has_permalink_marker">Your First Widget<i class="mdi-content-link"></i></h3><p>The initial demonstration module already provides a basic widget:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"pet store home page loaded"</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>It extends <code class="xref js js-class">Widget()</code> and overrides the standard method
<code class="xref js-func js">start()</code>, which — much like the previous <code>MyClass</code>
— does little for now.</p><p>This line at the end of the file:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span>
    <span class="s1">'petstore.homepage'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.HomePage'</span><span class="p">);</span>
</pre></div>
</div>
<p>registers our basic widget as a client action. Client actions will be
explained later, for now this is just what allows our widget to
be called and displayed when we select the
<span class="menuselection">Pet Store ‣ Pet Store ‣ Home Page</span> menu.</p><div role="alert" class="alert alert-warning"><h3 class="alert-title">Warning</h3><p>because the widget will be called from outside our module, the web client
needs its “fully qualified” name, not the local version.</p></div></section><section id="display-content"><h3 class="o_has_permalink_marker">Display Content<i class="mdi-content-link"></i></h3><p>Widgets have a number of methods and features, but the basics are simple:</p><ul><li>set up a widget</li><li>format the widget’s data</li><li>display the widget</li></ul><p>The <code>HomePage</code> widget already has a <code class="xref js-func js">start()</code>
method. That method is part of the normal widget lifecycle and automatically
called once the widget is inserted in the page. We can use it to display some
content.</p><p>All widgets have a <code class="xref js-attr js">$el</code> which represents the
section of page they’re in charge of (as a <a href="http://jquery.org/" class="reference external">jQuery</a> object). Widget content
should be inserted there. By default, <code class="xref js-attr js">$el</code> is an
empty <code>&lt;div&gt;</code> element.</p><p>A <code>&lt;div&gt;</code> element is usually invisible to the user if it has no content (or
without specific styles giving it a size) which is why nothing is displayed
on the page when <code>HomePage</code> is launched.</p><p>Let’s add some content to the widget’s root element, using jQuery:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"&lt;div&gt;Hello dear Odoo user!&lt;/div&gt;"</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>That message will now appear when you open <span class="menuselection">Pet Store
‣ Pet Store ‣ Home Page</span></p><div role="alert" class="alert alert-info"><h3 class="alert-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></h3><p>to refresh the javascript code loaded in Odoo Web, you will need to reload
the page. There is no need to restart the Odoo server.</p></div><p>The <code>HomePage</code> widget is used by Odoo Web and managed automatically.
To learn how to use a widget “from scratch” let’s create a new one:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"&lt;div&gt;We are so happy to see you again in this menu!&lt;/div&gt;"</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>We can now add our <code>GreetingsWidget</code> to the <code>HomePage</code> by using the
<code>GreetingsWidget</code>’s <code class="xref js-func js">appendTo()</code> method:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"&lt;div&gt;Hello dear Odoo user!&lt;/div&gt;"</span><span class="p">);</span>
        <span class="kd">var</span> <span class="nx">greeting</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="k">return</span> <span class="nx">greeting</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<ul><li><code>HomePage</code> first adds its own content to its DOM root</li><li><code>HomePage</code> then instantiates <code>GreetingsWidget</code></li><li>Finally it tells <code>GreetingsWidget</code> where to insert itself, delegating part
of its <code class="xref js-attr js">$el</code> to the <code>GreetingsWidget</code>.</li></ul><p>When the <code class="xref js-func js">appendTo()</code> method is called, it asks the
widget to insert itself at the specified position and to display its content.
The <code class="xref js-func js">start()</code> method will be called during the call
to <code class="xref js-func js">appendTo()</code>.</p><p>To see what happens under the displayed interface, we will use the browser’s
DOM Explorer. But first let’s alter our widgets slightly so we can more easily
find where they are, by <code class="xref js-attr js">adding a class to their root elements</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">className</span><span class="o">:</span> <span class="s1">'oe_petstore_homepage'</span><span class="p">,</span>
    <span class="p">...</span>
<span class="p">});</span>
<span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">className</span><span class="o">:</span> <span class="s1">'oe_petstore_greetings'</span><span class="p">,</span>
    <span class="p">...</span>
<span class="p">});</span>
</pre></div>
</div>
<p>If you can find the relevant section of the DOM (right-click on the text
then <span class="guilabel">Inspect Element</span>), it should look like this:</p><div class="highlight-html"><div class="highlight"><pre><span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"oe_petstore_homepage"</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>Hello dear Odoo user!<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">"oe_petstore_greetings"</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>We are so happy to see you again in this menu!<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>Which clearly shows the two <code>&lt;div&gt;</code> elements automatically created by
<code class="xref js js-class">Widget()</code>, because we added some classes on them.</p><p>We can also see the two message-holding divs we added ourselves</p><p>Finally, note the <code>&lt;div class="oe_petstore_greetings"&gt;</code> element which
represents the <code>GreetingsWidget</code> instance is <em>inside</em> the
<code>&lt;div class="oe_petstore_homepage"&gt;</code> which represents the <code>HomePage</code>
instance, since we appended</p></section><section id="widget-parents-and-children"><h3 class="o_has_permalink_marker">Widget Parents and Children<i class="mdi-content-link"></i></h3><p>In the previous part, we instantiated a widget using this syntax:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
</pre></div>
</div>
<p>The first argument is <code>this</code>, which in that case was a <code>HomePage</code>
instance. This tells the widget being created which other widget is its
<em>parent</em>.</p><p>As we’ve seen, widgets are usually inserted in the DOM by another widget and
<em>inside</em> that other widget’s root element. This means most widgets are “part”
of another widget, and exist on behalf of it. We call the container the
<em>parent</em>, and the contained widget the <em>child</em>.</p><p>Due to multiple technical and conceptual reasons, it is necessary for a widget
to know who is its parent and who are its children.</p><dl><dt><code class="xref js-func js">getParent()</code></dt><dd><p>can be used to get the parent of a widget:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getParent</span><span class="p">().</span><span class="nx">$el</span> <span class="p">);</span>
        <span class="c1">// will print "div.oe_petstore_homepage" in the console</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
</dd><dt><code class="xref js-func js">getChildren()</code></dt><dd><p>can be used to get a list of its children:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">greeting</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="nx">greeting</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">getChildren</span><span class="p">()[</span><span class="mi">0</span><span class="p">].</span><span class="nx">$el</span><span class="p">);</span>
        <span class="c1">// will print "div.oe_petstore_greetings" in the console</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
</dd></dl><p>When overriding the <code class="xref js-func js">init()</code> method of a widget it is
<em>of the utmost importance</em> to pass the parent to the <code>this._super()</code> call,
otherwise the relation will not be set up correctly:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span><span class="p">;</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Finally, if a widget does not have a parent (e.g. because it’s the root
widget of the application), <code>null</code> can be provided as parent:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">GreetingsWidget</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</pre></div>
</div>
</section><section id="destroying-widgets"><h3 class="o_has_permalink_marker">Destroying Widgets<i class="mdi-content-link"></i></h3><p>If you can display content to your users, you should also be able to erase
it. This is done via the <code class="xref js-func js">destroy()</code> method:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">greeting</span><span class="p">.</span><span class="nx">destroy</span><span class="p">();</span>
</pre></div>
</div>
<p>When a widget is destroyed it will first call
<code class="xref js-func js">destroy()</code> on all its children. Then it erases itself
from the DOM. If you have set up permanent structures in
<code class="xref js-func js">init()</code> or <code class="xref js-func js">start()</code> which
must be explicitly cleaned up (because the garbage collector will not handle
them), you can override <code class="xref js-func js">destroy()</code>.</p><div role="alert" class="alert alert-danger"><h3 class="alert-title">Danger</h3><p>when overriding <code class="xref js-func js">destroy()</code>, <code>_super()</code>
<em>must always</em> be called otherwise the widget and its children are not
correctly cleaned up leaving possible memory leaks and “phantom events”,
even if no error is displayed</p></div></section><section id="the-qweb-template-engine"><h2 class="o_has_permalink_marker">The QWeb Template Engine<i class="mdi-content-link"></i></h2><p>In the previous section we added content to our widgets by directly
manipulating (and adding to) their DOM:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"&lt;div&gt;Hello dear Odoo user!&lt;/div&gt;"</span><span class="p">);</span>
</pre></div>
</div>
<p>This allows generating and displaying any type of content, but gets unwieldy
when generating significant amounts of DOM (lots of duplication, quoting
issues, …)</p><p>As many other environments, Odoo’s solution is to use a <a href="http://en.wikipedia.org/wiki/Web_template_system" class="reference external">template engine</a>.
Odoo’s template engine is called <a href="https://www.odoo.com/documentation/master/reference/qweb.html#reference-qweb" class="reference internal"><span class="std-ref std">QWeb</span></a>.</p><p>QWeb is an XML-based templating language, similar to <a href="http://en.wikipedia.org/wiki/Genshi_(templating_language)" class="reference external">Genshi</a>, <a href="http://en.wikipedia.org/wiki/Thymeleaf" class="reference external">Thymeleaf</a> or <a href="http://en.wikipedia.org/wiki/Facelets" class="reference external">Facelets</a>. It has the following
characteristics:</p><ul><li>It’s implemented fully in JavaScript and rendered in the browser</li><li>Each template file (XML files) contains multiple templates</li><li>It has special support in Odoo Web’s <code class="xref js js-class">Widget()</code>, though it
can be used outside of Odoo’s web client (and it’s possible to use
<code class="xref js js-class">Widget()</code> without relying on QWeb)</li></ul><div role="alert" class="alert alert-info"><h3 class="alert-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></h3><p>The rationale behind using QWeb instead of existing javascript template
engines is the extensibility of pre-existing (third-party) templates, much
like Odoo <a href="https://www.odoo.com/documentation/master/reference/views.html#reference-views" class="reference internal alert-link"><span class="std-ref std">views</span></a>.</p><p>Most javascript template engines are text-based which precludes easy
structural extensibility where an XML-based templating engine can be
generically altered using e.g. XPath or CSS and a tree-alteration DSL (or
even just XSLT). This flexibility and extensibility is a core
characteristic of Odoo, and losing it was considered unacceptable.</p></div></section><section id="using-qweb"><h3 class="o_has_permalink_marker">Using QWeb<i class="mdi-content-link"></i></h3><p>First let’s define a simple QWeb template in the almost-empty
<code>oepetstore/static/src/xml/petstore.xml</code> file:</p><div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">"preserve"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"HomePageTemplate"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">style=</span><span class="s">"background-color: red;"</span><span class="nt">&gt;</span>This is some simple HTML<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<p>Now we can use this template inside of the <code>HomePage</code> widget. Using the
<code>QWeb</code> loader variable defined at the top of the page, we can call to the
template defined in the XML file:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">"HomePageTemplate"</span><span class="p">));</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p><code class="xref js-func js">QWeb.render()</code> looks for the specified template, renders it to a string
and returns the result.</p><p>However, because <code class="xref js js-class">Widget()</code> has special integration for QWeb
the template can be set directly on the widget via its
<code class="xref js-attr js">template</code> attribute:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s2">"HomePageTemplate"</span><span class="p">,</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">...</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Although the result looks similar, there are two differences between these
usages:</p><ul><li>with the second version, the template is rendered right before
<code class="xref js-func js">start()</code> is called</li><li>in the first version the template’s content is added to the widget’s root
element, whereas in the second version the template’s root element is
directly <em>set as</em> the widget’s root element. Which is why the “greetings”
sub-widget also gets a red background</li></ul><div role="alert" class="alert alert-warning"><h3 class="alert-title">Warning</h3><p>templates should have a single non-<code>t</code> root element, especially if
they’re set as a widget’s <code class="xref js-attr js">template</code>. If there are
multiple “root elements”, results are undefined (usually only the first
root element will be used and the others will be ignored)</p></div></section><section id="qweb-context"><h4 class="o_has_permalink_marker">QWeb Context<i class="mdi-content-link"></i></h4><p>QWeb templates can be given data and can contain basic display logic.</p><p>For explicit calls to <code class="xref js-func js">QWeb.render()</code>, the template data is passed as
second parameter:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">"HomePageTemplate"</span><span class="p">,</span> <span class="p">{</span><span class="nx">name</span><span class="o">:</span> <span class="s2">"Klaus"</span><span class="p">});</span>
</pre></div>
</div>
<p>with the template modified to:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"HomePageTemplate"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">"name"</span><span class="nt">/&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<p>will result in:</p><div class="highlight-html"><div class="highlight"><pre><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>Hello Klaus<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>When using <code class="xref js js-class">Widget()</code>’s integration it is not possible to
provide additional data to the template. The template will be given a single
<code>widget</code> context variable, referencing the widget being rendered right
before <code class="xref js-func js">start()</code> is called (the widget’s state will
essentially be that set up by <code class="xref js-func js">init()</code>):</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"HomePageTemplate"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div&gt;</span>Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">"widget.name"</span><span class="nt">/&gt;&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s2">"HomePageTemplate"</span><span class="p">,</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="s2">"Mordecai"</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>Result:</p><div class="highlight-html"><div class="highlight"><pre><span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>Hello Mordecai<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</pre></div>
</div>
</section><section id="template-declaration"><h4 class="o_has_permalink_marker">Template Declaration<i class="mdi-content-link"></i></h4><p>We’ve seen how to <em>render</em> QWeb templates, let’s now see the syntax of
the templates themselves.</p><p>A QWeb template is composed of regular XML mixed with QWeb <em>directives</em>. A
QWeb directive is declared with XML attributes starting with <code>t-</code>.</p><p>The most basic directive is <code>t-name</code>, used to declare new templates in
a template file:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;templates&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"HomePageTemplate"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>This is some simple HTML<span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<p><code>t-name</code> takes the name of the template being defined, and declares that
it can be called using <code class="xref js-func js">QWeb.render()</code>. It can only be used at the
top-level of a template file.</p></section><section id="escaping"><h4 class="o_has_permalink_marker">Escaping<i class="mdi-content-link"></i></h4><p>The <code>t-esc</code> directive can be used to output text:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">"name"</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>It takes a Javascript expression which is evaluated, the result of the
expression is then HTML-escaped and inserted in the document. Since it’s an
expression it’s possible to provide just a variable name as above, or a more
complex expression like a computation:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">"3+5"</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<p>or method calls:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">"name.toUpperCase()"</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
</section><section id="outputting-html"><h4 class="o_has_permalink_marker">Outputting HTML<i class="mdi-content-link"></i></h4><p>To inject HTML in the page being rendered, use <code>t-raw</code>. Like <code>t-esc</code> it
takes an arbitrary Javascript expression as parameter, but it does not
perform an HTML-escape step.</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;&lt;t</span> <span class="na">t-raw=</span><span class="s">"name.link(user_account)"</span><span class="nt">/&gt;&lt;/div&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert alert-danger"><h3 class="alert-title">Danger</h3><p><code>t-raw</code> <em>must not</em> be used on any data which may contain non-escaped
user-provided content as this leads to <a href="http://en.wikipedia.org/wiki/Cross-site_scripting" class="reference external alert-link">cross-site scripting</a>
vulnerabilities</p></div></section><section id="conditionals"><h4 class="o_has_permalink_marker">Conditionals<i class="mdi-content-link"></i></h4><p>QWeb can have conditional blocks using <code>t-if</code>. The directive takes an
arbitrary expression, if the expression is falsy (<code>false</code>, <code>null</code>, <code>0</code>
or an empty string) the whole block is suppressed, otherwise it is displayed.</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">"true == true"</span><span class="nt">&gt;</span><font></font>
        true is true<font></font>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">"true == false"</span><span class="nt">&gt;</span><font></font>
        true is not true<font></font>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert alert-info"><h3 class="alert-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></h3><p>QWeb doesn’t have an “else” structure, use a second <code>t-if</code> with the
original condition inverted. You may want to store the condition in a
local variable if it’s a complex or expensive expression.</p></div></section><section id="iteration"><h4 class="o_has_permalink_marker">Iteration<i class="mdi-content-link"></i></h4><p>To iterate on a list, use <code>t-foreach</code> and <code>t-as</code>. <code>t-foreach</code> takes an
expression returning a list to iterate on <code>t-as</code> takes a variable name to
bind to each item during iteration.</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">"names"</span> <span class="na">t-as=</span><span class="s">"name"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            Hello <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">"name"</span><span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert alert-info"><h3 class="alert-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></h3><p><code>t-foreach</code> can also be used with numbers and objects
(dictionaries)</p></div></section><section id="defining-attributes"><h4 class="o_has_permalink_marker">Defining attributes<i class="mdi-content-link"></i></h4><p>QWeb provides two related directives to define computed attributes:
<code class="samp">t-att-<em>name</em></code> and <code class="samp">t-attf-<em>name</em></code>. In either case, <em>name</em> is the
name of the attribute to create (e.g. <code>t-att-id</code> defines the attribute
<code>id</code> after rendering).</p><p><code>t-att-</code> takes a javascript expression whose result is set as the
attribute’s value, it is most useful if all of the attribute’s value is
computed:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div&gt;</span><font></font>
    Input your name:<font></font>
    <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">t-att-value=</span><span class="s">"defaultName"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p><code>t-attf-</code> takes a <em>format string</em>. A format string is literal text with
interpolation blocks inside, an interpolation block is a javascript
expression between <code>{{</code> and <code>}}</code>, which will be replaced by the result
of the expression. It is most useful for attributes which are partially
literal and partially computed such as a class:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">t-attf-class=</span><span class="s">"container {{ left ? 'text-left' : '' }} {{ extra_class }}"</span><span class="nt">&gt;</span><font></font>
    insert content here<font></font>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
</section><section id="calling-other-templates"><h4 class="o_has_permalink_marker">Calling other templates<i class="mdi-content-link"></i></h4><p>Templates can be split into sub-templates (for simplicity, maintainability,
reusability or to avoid excessive markup nesting).</p><p>This is done using the <code>t-call</code> directive, which takes the name of the
template to render:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"A"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"i-am-a"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-call=</span><span class="s">"B"</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"B"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"i-am-b"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<p>rendering the <code>A</code> template will result in:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"i-am-a"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"i-am-b"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/div&gt;</span>
</pre></div>
</div>
<p>Sub-templates inherit the rendering context of their caller.</p></section><section id="to-learn-more-about-qweb"><h4 class="o_has_permalink_marker">To Learn More About QWeb<i class="mdi-content-link"></i></h4><p>For a QWeb reference, see <a href="https://www.odoo.com/documentation/master/reference/qweb.html#reference-qweb" class="reference internal"><span class="std-ref std">QWeb</span></a>.</p></section><section id="exercise"><h4 class="o_has_permalink_marker">Exercise<i class="mdi-content-link"></i></h4><div role="alert" class="alert alert-exercise"><h3 class="alert-title">Exercise</h3><p>Usage of QWeb in Widgets</p><p>Create a widget whose constructor takes two parameters aside from
<code>parent</code>: <code>product_names</code> and <code>color</code>.</p><ul><li><code>product_names</code> should an array of strings, each one the name of a
product</li><li><code>color</code> is a string containing a color in CSS color format (ie:
<code>#000000</code> for black).</li></ul><p>The widget should display the given product names one under the other,
each one in a separate box with a background color with the value of
<code>color</code> and a border. You should use QWeb to render the HTML. Any
necessary CSS should be in <code>oepetstore/static/src/css/petstore.css</code>.</p><p>Use the widget in <code>HomePage</code> with half a dozen products.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">odoo</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">products</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">ProductsWidget</span><span class="p">(</span>
                <span class="k">this</span><span class="p">,</span> <span class="p">[</span><span class="s2">"cpu"</span><span class="p">,</span> <span class="s2">"mouse"</span><span class="p">,</span> <span class="s2">"keyboard"</span><span class="p">,</span> <span class="s2">"graphic card"</span><span class="p">,</span> <span class="s2">"screen"</span><span class="p">],</span> <span class="s2">"#00FF00"</span><span class="p">);</span>
            <span class="nx">products</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">});</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">ProductsWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">"ProductsWidget"</span><span class="p">,</span>
        <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">parent</span><span class="p">,</span> <span class="nx">products</span><span class="p">,</span> <span class="nx">color</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">(</span><span class="nx">parent</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">products</span> <span class="o">=</span> <span class="nx">products</span><span class="p">;</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">color</span> <span class="o">=</span> <span class="nx">color</span><span class="p">;</span>
        <span class="p">},</span>
    <span class="p">});</span><font></font>
<font></font>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span>
        <span class="s1">'petstore.homepage'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.HomePage'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">"preserve"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"ProductsWidget"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            <span class="nt">&lt;t</span> <span class="na">t-foreach=</span><span class="s">"widget.products"</span> <span class="na">t-as=</span><span class="s">"product"</span><span class="nt">&gt;</span>
                <span class="nt">&lt;span</span> <span class="na">class=</span><span class="s">"oe_products_item"</span>
                      <span class="na">t-attf-style=</span><span class="s">"background-color: {{ widget.color }};"</span><span class="nt">&gt;</span>
                    <span class="nt">&lt;t</span> <span class="na">t-esc=</span><span class="s">"product"</span><span class="nt">/&gt;</span>
                <span class="nt">&lt;/span&gt;</span>
                <span class="nt">&lt;br/&gt;</span>
            <span class="nt">&lt;/t&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<div class="highlight-css"><div class="highlight"><pre><span class="nc">.oe_products_item</span> <span class="p">{</span>
    <span class="nb">display</span><span class="o">:</span> <span class="nb">inline</span><span class="o">-</span><span class="nb">block</span><span class="p">;</span>
    <span class="nb">padding</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
    <span class="nb">margin</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nb">border</span><span class="o">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="nb">black</span><span class="p">;</span>
    <span class="nb">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<a href="./自定义Web客户端 - odoo 12.0文档_files/qweb.png" class="reference internal alert-link"><img src="./自定义Web客户端 - odoo 12.0文档_files/qweb.png" class="img-responsive center-block"></a></div></section><section id="widget-helpers"><h2 class="o_has_permalink_marker">Widget Helpers<i class="mdi-content-link"></i></h2></section><section id="widget-s-jquery-selector"><h3 class="o_has_permalink_marker"><code>Widget</code>’s jQuery Selector<i class="mdi-content-link"></i></h3><p>Selecting DOM elements within a widget can be performed by calling the
<code>find()</code> method on the widget’s DOM root:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="s2">"input.my_input"</span><span class="p">)...</span>
</pre></div>
</div>
<p>But because it’s a common operation, <code class="xref js js-class">Widget()</code> provides an
equivalent shortcut through the <code class="xref js-func js">$()</code> method:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">"input.my_input"</span><span class="p">)...</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<div role="alert" class="alert alert-warning"><h3 class="alert-title">Warning</h3><p>The global jQuery function <code>$()</code> should <em>never</em> be used unless it is
absolutely necessary: selection on a widget’s root are scoped to the
widget and local to it, but selections with <code>$()</code> are global to the
page/application and may match parts of other widgets and views, leading
to odd or dangerous side-effects. Since a widget should generally act
only on the DOM section it owns, there is no cause for global selection.</p></div></section><section id="easier-dom-events-binding"><h3 class="o_has_permalink_marker">Easier DOM Events Binding<i class="mdi-content-link"></i></h3><p>We have previously bound DOM events using normal jQuery event handlers (e.g.
<code>.click()</code> or <code>.change()</code>) on widget elements:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">".my_button"</span><span class="p">).</span><span class="nx">click</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">button_clicked</span><span class="p">();</span>
        <span class="p">});</span>
    <span class="p">},</span>
    <span class="nx">button_clicked</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">..</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>While this works it has a few issues:</p><ol><li>it is rather verbose</li><li>it does not support replacing the widget’s root element at runtime as
the binding is only performed when <code>start()</code> is run (during widget
initialization)</li><li>it requires dealing with <code>this</code>-binding issues</li></ol><p>Widgets thus provide a shortcut to DOM event binding via
<code class="xref js-attr js">events</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">MyWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s2">"click .my_button"</span><span class="o">:</span> <span class="s2">"button_clicked"</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">button_clicked</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="p">..</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p><code class="xref js-attr js">events</code> is an object (mapping) of an event to the
function or method to call when the event is triggered:</p><ul><li>the key is an event name, possibly refined with a CSS selector in which
case only if the event happens on a selected sub-element will the function
or method run: <code>click</code> will handle all clicks within the widget, but
<code>click .my_button</code> will only handle clicks in elements bearing the
<code>my_button</code> class</li><li><p>the value is the action to perform when the event is triggered</p><p>It can be either a function:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
    <span class="s1">'click'</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span> <span class="cm">/* code here */</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>or the name of a method on the object (see example above).</p><p>In either case, the <code>this</code> is the widget instance and the handler is given
a single parameter, the <a href="http://api.jquery.com/category/events/event-object/" class="reference external">jQuery event object</a> for the event.</p></li></ul></section><section id="widget-events-and-properties"><h2 class="o_has_permalink_marker">Widget Events and Properties<i class="mdi-content-link"></i></h2></section><section id="events"><h3 class="o_has_permalink_marker">Events<i class="mdi-content-link"></i></h3><p>Widgets provide an event system (separate from the DOM/jQuery event system
described above): a widget can fire events on itself, and other widgets (or
itself) can bind themselves and listen for these events:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">ConfirmWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">'click button.ok_button'</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">'user_chose'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="s1">'click button.cancel_button'</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s1">'user_chose'</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"&lt;div&gt;Are you sure you want to perform this action?&lt;/div&gt;"</span> <span class="o">+</span>
            <span class="s2">"&lt;button class='ok_button'&gt;Ok&lt;/button&gt;"</span> <span class="o">+</span>
            <span class="s2">"&lt;button class='cancel_button'&gt;Cancel&lt;/button&gt;"</span><span class="p">);</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>This widget acts as a facade, transforming user input (through DOM events)
into a documentable internal event to which parent widgets can bind
themselves.</p><p><code class="xref js-func js">trigger()</code> takes the name of the event to trigger as
its first (mandatory) argument, any further arguments are treated as event
data and passed directly to listeners.</p><p>We can then set up a parent event instantiating our generic widget and
listening to the <code>user_chose</code> event using <code class="xref js-func js">on()</code>:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">widget</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">ConfirmWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
        <span class="nx">widget</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"user_chose"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">user_chose</span><span class="p">);</span>
        <span class="nx">widget</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">user_chose</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">confirm</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"The user agreed to continue"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"The user refused to continue"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p><code class="xref js-func js">on()</code> binds a function to be called when the
event identified by <code>event_name</code> is. The <code>func</code> argument is the
function to call and <code>object</code> is the object to which that function is
related if it is a method. The bound function will be called with the
additional arguments of <code class="xref js-func js">trigger()</code> if it has
any. Example:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">widget</span> <span class="o">=</span> <span class="p">...</span>
    <span class="nx">widget</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"my_event"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">my_event_triggered</span><span class="p">);</span>
    <span class="nx">widget</span><span class="p">.</span><span class="nx">trigger</span><span class="p">(</span><span class="s2">"my_event"</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">},</span>
<span class="nx">my_event_triggered</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">,</span> <span class="nx">c</span><span class="p">);</span>
    <span class="c1">// will print "1 2 3"</span>
<span class="p">}</span>
</pre></div>
</div>
<div role="alert" class="alert alert-info"><h3 class="alert-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></h3><p>Triggering events on an other widget is generally a bad idea. The main
exception to that rule is <code>odoo.web.bus</code> which exists specifically
to broadcasts evens in which any widget could be interested throughout
the Odoo web application.</p></div></section><section id="properties"><h3 class="o_has_permalink_marker">Properties<i class="mdi-content-link"></i></h3><p>Properties are very similar to normal object attributes in that they allow
storing data on a widget instance, however they have the additional feature
that they trigger events when set:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">widget</span> <span class="o">=</span> <span class="p">...</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"change:name"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">name_changed</span><span class="p">);</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">"name"</span><span class="p">,</span> <span class="s2">"Nicolas"</span><span class="p">);</span>
<span class="p">},</span>
<span class="nx">name_changed</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">"The new value of the property 'name' is"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">widget</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"name"</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<ul><li><code class="xref js-func js">set()</code> sets the value of a property and triggers
<code class="samp">change:<em>propname</em></code> (where <em>propname</em> is the property name passed as
first parameter to <code class="xref js-func js">set()</code>) and <code>change</code></li><li><code class="xref js-func js">get()</code> retrieves the value of a property.</li></ul></section><section id="id3"><h3 class="o_has_permalink_marker">Exercise<i class="mdi-content-link"></i></h3><div role="alert" class="alert alert-exercise"><h3 class="alert-title">Exercise</h3><p>Widget Properties and Events</p><p>Create a widget <code>ColorInputWidget</code> that will display 3 <code>&lt;input
type="text"&gt;</code>. Each of these <code>&lt;input&gt;</code> is dedicated to type a
hexadecimal number from 00 to FF. When any of these <code>&lt;input&gt;</code> is
modified by the user the widget must query the content of the three
<code>&lt;input&gt;</code>, concatenate their values to have a complete CSS color code
(ie: <code>#00FF00</code>) and put the result in a property named <code>color</code>. Please
note the jQuery <code>change()</code> event that you can bind on any HTML
<code>&lt;input&gt;</code> element and the <code>val()</code> method that can query the current
value of that <code>&lt;input&gt;</code> could be useful to you for this exercise.</p><p>Then, modify the <code>HomePage</code> widget to instantiate <code>ColorInputWidget</code>
and display it. The <code>HomePage</code> widget should also display an empty
rectangle. That rectangle must always, at any moment, have the same
background color as the color in the <code>color</code> property of the
<code>ColorInputWidget</code> instance.</p><p>Use QWeb to generate all HTML.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">odoo</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">ColorInputWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">"ColorInputWidget"</span><span class="p">,</span>
        <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
            <span class="s1">'change input'</span><span class="o">:</span> <span class="s1">'input_changed'</span>
        <span class="p">},</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">input_changed</span><span class="p">();</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="p">},</span>
        <span class="nx">input_changed</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">color</span> <span class="o">=</span> <span class="p">[</span>
                <span class="s2">"#"</span><span class="p">,</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">".oe_color_red"</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">".oe_color_green"</span><span class="p">).</span><span class="nx">val</span><span class="p">(),</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">".oe_color_blue"</span><span class="p">).</span><span class="nx">val</span><span class="p">()</span>
            <span class="p">].</span><span class="nx">join</span><span class="p">(</span><span class="s1">''</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">"color"</span><span class="p">,</span> <span class="nx">color</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">});</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">"HomePage"</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">colorInput</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">ColorInputWidget</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">colorInput</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"change:color"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">color_changed</span><span class="p">);</span>
            <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">colorInput</span><span class="p">.</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
        <span class="p">},</span>
        <span class="nx">color_changed</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">".oe_color_div"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">"background-color"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">colorInput</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"color"</span><span class="p">));</span>
        <span class="p">},</span>
    <span class="p">});</span><font></font>
<font></font>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'petstore.homepage'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.HomePage'</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">"preserve"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"ColorInputWidget"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            Red: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"oe_color_red"</span> <span class="na">value=</span><span class="s">"00"</span><span class="nt">&gt;&lt;/input&gt;&lt;br</span> <span class="nt">/&gt;</span>
            Green: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"oe_color_green"</span> <span class="na">value=</span><span class="s">"00"</span><span class="nt">&gt;&lt;/input&gt;&lt;br</span> <span class="nt">/&gt;</span>
            Blue: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span> <span class="na">class=</span><span class="s">"oe_color_blue"</span> <span class="na">value=</span><span class="s">"00"</span><span class="nt">&gt;&lt;/input&gt;&lt;br</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"HomePage"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_color_div"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<div class="highlight-css"><div class="highlight"><pre><span class="nc">.oe_color_div</span> <span class="p">{</span>
    <span class="nb">width</span><span class="o">:</span> <span class="m">100px</span><span class="p">;</span>
    <span class="nb">height</span><span class="o">:</span> <span class="m">100px</span><span class="p">;</span>
    <span class="nb">margin</span><span class="o">:</span> <span class="m">10px</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></section><section id="modify-existing-widgets-and-classes"><h2 class="o_has_permalink_marker">Modify existing widgets and classes<i class="mdi-content-link"></i></h2><p>The class system of the Odoo web framework allows direct modification of
existing classes using the <code class="xref js-func js">include()</code> method:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">TestClass</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Class</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">testMethod</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="s2">"hello"</span><span class="p">;</span>
    <span class="p">},</span>
<span class="p">});</span><font></font>
<font></font>
<span class="nx">TestClass</span><span class="p">.</span><span class="nx">include</span><span class="p">({</span>
    <span class="nx">testMethod</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">()</span> <span class="o">+</span> <span class="s2">" world"</span><span class="p">;</span>
    <span class="p">},</span>
<span class="p">});</span><font></font>
<font></font>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">new</span> <span class="nx">TestClass</span><span class="p">().</span><span class="nx">testMethod</span><span class="p">());</span>
<span class="c1">// will print "hello world"</span>
</pre></div>
</div>
<p>This system is similar to the inheritance mechanism, except it will alter the
target class in-place instead of creating a new class.</p><p>In that case, <code>this._super()</code> will call the original implementation of a
method being replaced/redefined. If the class already had sub-classes, all
calls to <code>this._super()</code> in sub-classes will call the new implementations
defined in the call to <code class="xref js-func js">include()</code>. This will also work
if some instances of the class (or of any of its sub-classes) were created
prior to the call to <code class="xref js-func js">include()</code>.</p></section><section id="translations"><h2 class="o_has_permalink_marker">Translations<i class="mdi-content-link"></i></h2><p>The process to translate text in Python and JavaScript code is very
similar. You could have noticed these lines at the beginning of the
<code>petstore.js</code> file:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
    <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
</pre></div>
</div>
<p>These lines are simply used to import the translation functions in the current
JavaScript module. They are used thus:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">_t</span><span class="p">(</span><span class="s2">"Hello user!"</span><span class="p">));</span>
</pre></div>
</div>
<p>In Odoo, translations files are automatically generated by scanning the source
code. All piece of code that calls a certain function are detected and their
content is added to a translation file that will then be sent to the
translators. In Python, the function is <code>_()</code>. In JavaScript the function is
<code class="xref js-func js">_t()</code> (and also <code class="xref js-func js">_lt()</code>).</p><p><code>_t()</code> will return the translation defined for the text it is given. If no
translation is defined for that text, it will return the original text as-is.</p><div role="alert" class="alert alert-info"><h3 class="alert-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></h3><p>To inject user-provided values in translatable strings, it is recommended
to use <a href="http://gabceb.github.io/underscore.string.site/#sprintf" class="reference external alert-link">_.str.sprintf</a> with named
arguments <em>after</em> the translation:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="nx">_</span><span class="p">.</span><span class="nx">str</span><span class="p">.</span><span class="nx">sprintf</span><span class="p">(</span>
    <span class="nx">_t</span><span class="p">(</span><span class="s2">"Hello, %(user)s!"</span><span class="p">),</span> <span class="p">{</span>
    <span class="nx">user</span><span class="o">:</span> <span class="s2">"Ed"</span>
<span class="p">}));</span>
</pre></div>
</div>
<p>This makes translatable strings more readable to translators, and gives
them more flexibility to reorder or ignore parameters.</p></div><p><code class="xref js-func js">_lt()</code> (“lazy translate”) is similar but somewhat more
complex: instead of translating its parameter immediately, it returns
an object which, when converted to a string, will perform the translation.</p><p>It is used to define translatable terms before the translations system is
initialized, for class attributes for instance (as modules are loaded before
the user’s language is configured and translations are downloaded).</p></section><section id="communication-with-the-odoo-server"><h2 class="o_has_permalink_marker">Communication with the Odoo Server<i class="mdi-content-link"></i></h2></section><section id="contacting-models"><h3 class="o_has_permalink_marker">Contacting Models<i class="mdi-content-link"></i></h3><p>Most operations with Odoo involve communicating with <em>models</em> implementing
business concern, these models will then (potentially) interact with some
storage engine (usually <a href="http://en.wikipedia.org/wiki/PostgreSQL" class="reference external">PostgreSQL</a>).</p><p>Although <a href="http://jquery.org/" class="reference external">jQuery</a> provides a <a href="http://api.jquery.com/jquery.ajax/" class="reference external">$.ajax</a> function for network interactions,
communicating with Odoo requires additional metadata whose setup before every
call would be verbose and error-prone. As a result, Odoo web provides
higher-level communication primitives.</p><p>To demonstrate this, the file <code>petstore.py</code> already contains a small model
with a sample method:</p><div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">message_of_the_day</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s2">"oepetstore.message_of_the_day"</span><font></font>
<font></font>
    <span class="nd">@api.model</span>
    <span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span><span class="s2">"hello"</span><span class="p">:</span> <span class="s2">"world"</span><span class="p">}</span><font></font>
<font></font>
    <span class="n">message</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">(),</span>
    <span class="n">color</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Char</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">20</span><span class="p">),</span>
</pre></div>
</div>
<p>This declares a model with two fields, and a method <code>my_method()</code> which
returns a literal dictionary.</p><p>Here is a sample widget that calls <code>my_method()</code> and displays the result:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">model</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s2">"oepetstore.message_of_the_day"</span><span class="p">);</span>
        <span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"my_method"</span><span class="p">,</span> <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">CompoundContext</span><span class="p">()}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">self</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s2">"&lt;div&gt;Hello "</span> <span class="o">+</span> <span class="nx">result</span><span class="p">[</span><span class="s2">"hello"</span><span class="p">]</span> <span class="o">+</span> <span class="s2">"&lt;/div&gt;"</span><span class="p">);</span>
            <span class="c1">// will show "Hello world" to the user</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The class used to call Odoo models is <code class="xref js js-class">odoo.Model()</code>. It is
instantiated with the Odoo model’s name as first parameter
(<code>oepetstore.message_of_the_day</code> here).</p><p><code class="xref js-func js">call()</code> can be used to call any (public) method of an
Odoo model. It takes the following positional arguments:</p><dl><dt><code>name</code></dt><dd>The name of the method to call, <code>my_method</code> here</dd><dt><code>args</code></dt><dd><p>an array of <a href="https://docs.python.org/2/glossary.html#term-argument" class="reference external">positional arguments</a> to provide to the method. Because the
example has no positional argument to provide, the <code>args</code> parameter is not
provided.</p><p>Here is an other example with positional arguments:</p><div class="highlight-python"><div class="highlight"><pre><span class="nd">@api.model</span>
<span class="k">def</span> <span class="nf">my_method2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"my_method"</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">...</span>
<span class="c1">// with this a=1, b=2 and c=3</span>
</pre></div>
</div>
</dd><dt><code>kwargs</code></dt><dd><p>a mapping of <a href="https://docs.python.org/2/glossary.html#term-argument" class="reference external">keyword arguments</a> to pass. The example provides a single
named argument <code>context</code>.</p><div class="highlight-python"><div class="highlight"><pre><span class="nd">@api.model</span>
<span class="k">def</span> <span class="nf">my_method2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"my_method"</span><span class="p">,</span> <span class="p">[],</span> <span class="p">{</span><span class="nx">a</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">b</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">c</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span> <span class="p">...</span>
<span class="c1">// with this a=1, b=2 and c=3</span>
</pre></div>
</div>
</dd></dl><p><code class="xref js-func js">call()</code> returns a deferred resolved with the value
returned by the model’s method as first argument.</p></section><section id="compoundcontext"><h3 class="o_has_permalink_marker">CompoundContext<i class="mdi-content-link"></i></h3><p>The previous section used a <code>context</code> argument which was not explained in
the method call:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"my_method"</span><span class="p">,</span> <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">CompoundContext</span><span class="p">()})</span>
</pre></div>
</div>
<p>The context is like a “magic” argument that the web client will always give to
the server when calling a method. The context is a dictionary containing
multiple keys. One of the most important key is the language of the user, used
by the server to translate all the messages of the application. Another one is
the time zone of the user, used to compute correctly dates and times if Odoo
is used by people in different countries.</p><p>The <code>argument</code> is necessary in all methods, otherwise bad things could
happen (such as the application not being translated correctly). That’s why,
when you call a model’s method, you should always provide that argument. The
solution to achieve that is to use <code class="xref js js-class">odoo.web.CompoundContext()</code>.</p><p><code class="xref js js-class">CompoundContext()</code> is a class used to pass the user’s
context (with language, time zone, etc…) to the server as well as adding new
keys to the context (some models’ methods use arbitrary keys added to the
context). It is created by giving to its constructor any number of
dictionaries or other <code class="xref js js-class">CompoundContext()</code> instances. It will
merge all those contexts before sending them to the server.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s2">"my_method"</span><span class="p">,</span> <span class="p">{</span><span class="nx">context</span><span class="o">:</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">CompoundContext</span><span class="p">({</span><span class="s1">'new_key'</span><span class="o">:</span> <span class="s1">'key_value'</span><span class="p">})})</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="nd">@api.model</span>
<span class="k">def</span> <span class="nf">my_method</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">context</span>
    <span class="o">//</span> <span class="n">will</span> <span class="k">print</span><span class="p">:</span> <span class="p">{</span><span class="s1">'lang'</span><span class="p">:</span> <span class="s1">'en_US'</span><span class="p">,</span> <span class="s1">'new_key'</span><span class="p">:</span> <span class="s1">'key_value'</span><span class="p">,</span> <span class="s1">'tz'</span><span class="p">:</span> <span class="s1">'Europe/Brussels'</span><span class="p">,</span> <span class="s1">'uid'</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
</pre></div>
</div>
<p>You can see the dictionary in the argument <code>context</code> contains some keys that
are related to the configuration of the current user in Odoo plus the
<code>new_key</code> key that was added when instantiating
<code class="xref js js-class">CompoundContext()</code>.</p></section><section id="queries"><h3 class="o_has_permalink_marker">Queries<i class="mdi-content-link"></i></h3><p>While <code class="xref js-func js">call()</code> is sufficient for any interaction with Odoo
models, Odoo Web provides a helper for simpler and clearer querying of models
(fetching of records based on various conditions):
<code class="xref js-func js">query()</code> which acts as a shortcut for the common
combination of <a href="https://www.odoo.com/documentation/master/reference/orm.html#odoo.models.Model.search" title="odoo.models.Model.search" class="reference internal"><code class="xref py-meth py">search()</code></a> and
:<a href="https://www.odoo.com/documentation/master/reference/orm.html#odoo.models.Model.read" title="odoo.models.Model.read" class="reference internal"><code class="xref py-meth py">read()</code></a>. It provides a clearer syntax to search
and read models:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'login'</span><span class="p">,</span> <span class="s1">'user_email'</span><span class="p">,</span> <span class="s1">'signature'</span><span class="p">])</span>
     <span class="p">.</span><span class="nx">filter</span><span class="p">([[</span><span class="s1">'active'</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="kc">true</span><span class="p">],</span> <span class="p">[</span><span class="s1">'company_id'</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nx">main_company</span><span class="p">]])</span>
     <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
     <span class="p">.</span><span class="nx">all</span><span class="p">().</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">users</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do work with users records</span>
<span class="p">});</span>
</pre></div>
</div>
<p>versus:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'search'</span><span class="p">,</span> <span class="p">[[</span><span class="s1">'active'</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="kc">true</span><span class="p">],</span> <span class="p">[</span><span class="s1">'company_id'</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="nx">main_company</span><span class="p">]],</span> <span class="p">{</span><span class="nx">limit</span><span class="o">:</span> <span class="mi">15</span><span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">ids</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">model</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="s1">'read'</span><span class="p">,</span> <span class="p">[</span><span class="nx">ids</span><span class="p">,</span> <span class="p">[</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'login'</span><span class="p">,</span> <span class="s1">'user_email'</span><span class="p">,</span> <span class="s1">'signature'</span><span class="p">]]);</span>
    <span class="p">})</span>
    <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">users</span><span class="p">)</span> <span class="p">{</span>
        <span class="c1">// do work with users records</span>
    <span class="p">});</span>
</pre></div>
</div>
<ul><li><code class="xref js-func js">query()</code> takes an optional list of fields as
parameter (if no field is provided, all fields of the model are fetched). It
returns a <code class="xref js js-class">odoo.web.Query()</code> which can be further customized before
being executed</li><li><code class="xref js js-class">Query()</code> represents the query being built. It is
immutable, methods to customize the query actually return a modified copy,
so it’s possible to use the original and the new version side-by-side. See
<code class="xref js js-class">Query()</code> for its customization options.</li></ul><p>When the query is set up as desired, simply call
<code class="xref js-func js">all()</code> to execute it and return a
deferred to its result. The result is the same as
<a href="https://www.odoo.com/documentation/master/reference/orm.html#odoo.models.Model.read" title="odoo.models.Model.read" class="reference internal"><code class="xref py-meth py">read()</code></a>’s, an array of dictionaries where each
dictionary is a requested record, with each requested field a dictionary key.</p></section><section id="exercises"><h2 class="o_has_permalink_marker">Exercises<i class="mdi-content-link"></i></h2><div role="alert" class="alert alert-exercise"><h3 class="alert-title">Exercise</h3><p>Message of the Day</p><p>Create a <code>MessageOfTheDay</code>  widget displaying the last record of the
<code>oepetstore.message_of_the_day</code> model. The widget should fetch its
record as soon as it is displayed.</p><p>Display the widget in the Pet Store home page.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">odoo</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">"HomePage"</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">MessageOfTheDay</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">);</span>
        <span class="p">},</span>
    <span class="p">});</span><font></font>
<font></font>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'petstore.homepage'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.HomePage'</span><span class="p">);</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">MessageOfTheDay</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">"MessageOfTheDay"</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s2">"oepetstore.message_of_the_day"</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s2">"message"</span><span class="p">])</span>
                <span class="p">.</span><span class="nx">order_by</span><span class="p">(</span><span class="s1">'-create_date'</span><span class="p">,</span> <span class="s1">'-id'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">first</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">".oe_mywidget_message_of_the_day"</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
                <span class="p">});</span>
        <span class="p">},</span>
    <span class="p">});</span><font></font>
<font></font>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">"preserve"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"HomePage"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_petstore_homepage"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"MessageOfTheDay"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_petstore_motd"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"oe_mywidget_message_of_the_day"</span><span class="nt">&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<div class="highlight-css"><div class="highlight"><pre><span class="nc">.oe_petstore_motd</span> <span class="p">{</span>
    <span class="nb">margin</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nb">padding</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nb">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
    <span class="nb">background-color</span><span class="o">:</span> <span class="m">#F0EEEE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div role="alert" class="alert alert-exercise"><h3 class="alert-title">Exercise</h3><p>Pet Toys List</p><p>Create a <code>PetToysList</code> widget displaying 5 toys (using their name and
their images).</p><p>The pet toys are not stored in a new model, instead they’re stored in
<code>product.product</code> using a special category <em>Pet Toys</em>. You can see the
pre-generated toys and add new ones by going to
<span class="menuselection">Pet Store ‣ Pet Store ‣ Pet Toys</span>. You will probably
need to explore <code>product.product</code> to create the right domain to
select just pet toys.</p><p>In Odoo, images are generally stored in regular fields encoded as
<a href="http://en.wikipedia.org/wiki/Base64" class="reference external alert-link">base64</a>, HTML supports displaying images straight from base64 with
<code class="samp">&lt;img src="data:<em>mime_type</em>;base64,<em>base64_image_data</em>"/&gt;</code></p><p>The <code>PetToysList</code> widget should be displayed on the home page on the
right of the <code>MessageOfTheDay</code> widget. You will need to make some layout
with CSS to achieve this.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">odoo</span><span class="p">.</span><span class="nx">oepetstore</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">instance</span><span class="p">,</span> <span class="nx">local</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">var</span> <span class="nx">_t</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_t</span><span class="p">,</span>
        <span class="nx">_lt</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">_lt</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">QWeb</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">qweb</span><span class="p">;</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">HomePage</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s2">"HomePage"</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">([</span>
                <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">PetToysList</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">'.oe_petstore_homepage_left'</span><span class="p">)),</span>
                <span class="k">new</span> <span class="nx">local</span><span class="p">.</span><span class="nx">MessageOfTheDay</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s1">'.oe_petstore_homepage_right'</span><span class="p">))</span>
            <span class="p">]);</span>
        <span class="p">}</span>
    <span class="p">});</span>
    <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'petstore.homepage'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.HomePage'</span><span class="p">);</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">MessageOfTheDay</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s1">'MessageOfTheDay'</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s1">'oepetstore.message_of_the_day'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s2">"message"</span><span class="p">])</span>
                <span class="p">.</span><span class="nx">order_by</span><span class="p">(</span><span class="s1">'-create_date'</span><span class="p">,</span> <span class="s1">'-id'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">first</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">".oe_mywidget_message_of_the_day"</span><span class="p">).</span><span class="nx">text</span><span class="p">(</span><span class="nx">result</span><span class="p">.</span><span class="nx">message</span><span class="p">);</span>
                <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">});</span><font></font>
<font></font>
    <span class="nx">local</span><span class="p">.</span><span class="nx">PetToysList</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
        <span class="nx">template</span><span class="o">:</span> <span class="s1">'PetToysList'</span><span class="p">,</span>
        <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
            <span class="k">return</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s1">'product.product'</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'image'</span><span class="p">])</span>
                <span class="p">.</span><span class="nx">filter</span><span class="p">([[</span><span class="s1">'categ_id.name'</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="s2">"Pet Toys"</span><span class="p">]])</span>
                <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                <span class="p">.</span><span class="nx">all</span><span class="p">()</span>
                <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">_</span><span class="p">(</span><span class="nx">results</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nx">self</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'PetToy'</span><span class="p">,</span> <span class="p">{</span><span class="nx">item</span><span class="o">:</span> <span class="nx">item</span><span class="p">}));</span>
                    <span class="p">});</span>
                <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><font></font>
<font></font>
<span class="nt">&lt;templates</span> <span class="na">xml:space=</span><span class="s">"preserve"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"HomePage"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_petstore_homepage"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_petstore_homepage_left"</span><span class="nt">&gt;&lt;/div&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_petstore_homepage_right"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"MessageOfTheDay"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_petstore_motd"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p</span> <span class="na">class=</span><span class="s">"oe_mywidget_message_of_the_day"</span><span class="nt">&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"PetToysList"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_petstore_pettoyslist"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"PetToy"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_petstore_pettoy"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;p&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">"item.name"</span><span class="nt">/&gt;&lt;/p&gt;</span>
            <span class="nt">&lt;p&gt;&lt;img</span> <span class="na">t-att-src=</span><span class="s">"'data:image/jpg;base64,'+item.image"</span><span class="nt">/&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;/t&gt;</span>
<span class="nt">&lt;/templates&gt;</span>
</pre></div>
</div>
<div class="highlight-css"><div class="highlight"><pre><span class="nc">.oe_petstore_homepage</span> <span class="p">{</span>
    <span class="nb">display</span><span class="o">:</span> <span class="n">table</span><span class="p">;</span>
<span class="p">}</span><font></font>
<font></font>
<span class="nc">.oe_petstore_homepage_left</span> <span class="p">{</span>
    <span class="nb">display</span><span class="o">:</span> <span class="nb">table-cell</span><span class="p">;</span>
    <span class="nb">width</span> <span class="o">:</span> <span class="m">300px</span><span class="p">;</span>
<span class="p">}</span><font></font>
<font></font>
<span class="nc">.oe_petstore_homepage_right</span> <span class="p">{</span>
    <span class="nb">display</span><span class="o">:</span> <span class="nb">table-cell</span><span class="p">;</span>
    <span class="nb">width</span> <span class="o">:</span> <span class="m">300px</span><span class="p">;</span>
<span class="p">}</span><font></font>
<font></font>
<span class="nc">.oe_petstore_motd</span> <span class="p">{</span>
    <span class="nb">margin</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nb">padding</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nb">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
    <span class="nb">background-color</span><span class="o">:</span> <span class="m">#F0EEEE</span><span class="p">;</span>
<span class="p">}</span><font></font>
<font></font>
<span class="nc">.oe_petstore_pettoyslist</span> <span class="p">{</span>
    <span class="nb">padding</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
<span class="p">}</span><font></font>
<font></font>
<span class="nc">.oe_petstore_pettoy</span> <span class="p">{</span>
    <span class="nb">margin</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nb">padding</span><span class="o">:</span> <span class="m">5px</span><span class="p">;</span>
    <span class="nb">border</span><span class="o">-</span><span class="n">radius</span><span class="o">:</span> <span class="m">3px</span><span class="p">;</span>
    <span class="nb">background-color</span><span class="o">:</span> <span class="m">#F0EEEE</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></section><section id="existing-web-components"><h2 class="o_has_permalink_marker">Existing web components<i class="mdi-content-link"></i></h2></section><section id="the-action-manager"><h3 class="o_has_permalink_marker">The Action Manager<i class="mdi-content-link"></i></h3><p>In Odoo, many operations start from an <a href="https://www.odoo.com/documentation/master/reference/actions.html#reference-actions" class="reference internal"><span class="std-ref std">action</span></a>:
opening a menu item (to a view), printing a report, …</p><p>Actions are pieces of data describing how a client should react to the
activation of a piece of content. Actions can be stored (and read through a
model) or they can be generated on-the fly (locally to the client by
javascript code, or remotely by a method of a model).</p><p>In Odoo Web, the component responsible for handling and reacting to these
actions is the <em>Action Manager</em>.</p></section><section id="using-the-action-manager"><h4 class="o_has_permalink_marker">Using the Action Manager<i class="mdi-content-link"></i></h4><p>The action manager can be invoked explicitly from javascript code by creating
a dictionary describing <a href="https://www.odoo.com/documentation/master/reference/actions.html#reference-actions" class="reference internal"><span class="std-ref std">an action</span></a> of the right
type, and calling an action manager instance with it.</p><p><code class="xref js-func js">do_action()</code> is a shortcut of <code class="xref js js-class">Widget()</code>
looking up the “current” action manager and executing the action:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">TestWidget</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">dispatch_to_new_action</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">do_action</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">'ir.actions.act_window'</span><span class="p">,</span>
            <span class="nx">res_model</span><span class="o">:</span> <span class="s2">"product.product"</span><span class="p">,</span>
            <span class="nx">res_id</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="nx">views</span><span class="o">:</span> <span class="p">[[</span><span class="kc">false</span><span class="p">,</span> <span class="s1">'form'</span><span class="p">]],</span>
            <span class="nx">target</span><span class="o">:</span> <span class="s1">'current'</span><span class="p">,</span>
            <span class="nx">context</span><span class="o">:</span> <span class="p">{},</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<p>The most common action <code>type</code> is <code>ir.actions.act_window</code> which provides
views to a model (displays a model in various manners), its most common
attributes are:</p><dl><dt><code>res_model</code></dt><dd>The model to display in views</dd><dt><code>res_id</code> (optional)</dt><dd>For form views, a preselected record in <code>res_model</code></dd><dt><code>views</code></dt><dd>Lists the views available through the action. A list of
<code>[view_id, view_type]</code>, <code>view_id</code> can either be the database identifier
of a view of the right type, or <code>false</code> to use the view by default for
the specified type. View types can not be present multiple times. The action
will open the first view of the list by default.</dd><dt><code>target</code></dt><dd>Either <code>current</code> (the default) which replaces the “content” section of the
web client by the action, or <code>new</code> to open the action in a dialog box.</dd><dt><code>context</code></dt><dd>Additional context data to use within the action.</dd></dl><div role="alert" class="alert alert-exercise"><h3 class="alert-title">Exercise</h3><p>Jump to Product</p><p>Modify the <code>PetToysList</code> component so clicking on a toy replaces the
homepage by the toy’s form view.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">PetToysList</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">Widget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">template</span><span class="o">:</span> <span class="s1">'PetToysList'</span><span class="p">,</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">'click .oe_petstore_pettoy'</span><span class="o">:</span> <span class="s1">'selected_item'</span><span class="p">,</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">return</span> <span class="k">new</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">Model</span><span class="p">(</span><span class="s1">'product.product'</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">query</span><span class="p">([</span><span class="s1">'name'</span><span class="p">,</span> <span class="s1">'image'</span><span class="p">])</span>
            <span class="p">.</span><span class="nx">filter</span><span class="p">([[</span><span class="s1">'categ_id.name'</span><span class="p">,</span> <span class="s1">'='</span><span class="p">,</span> <span class="s2">"Pet Toys"</span><span class="p">]])</span>
            <span class="p">.</span><span class="nx">limit</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
            <span class="p">.</span><span class="nx">all</span><span class="p">()</span>
            <span class="p">.</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">results</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">_</span><span class="p">(</span><span class="nx">results</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">item</span><span class="p">)</span> <span class="p">{</span>
                    <span class="nx">self</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s1">'PetToy'</span><span class="p">,</span> <span class="p">{</span><span class="nx">item</span><span class="o">:</span> <span class="nx">item</span><span class="p">}));</span>
                <span class="p">});</span>
            <span class="p">});</span>
    <span class="p">},</span>
    <span class="nx">selected_item</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">event</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">do_action</span><span class="p">({</span>
            <span class="nx">type</span><span class="o">:</span> <span class="s1">'ir.actions.act_window'</span><span class="p">,</span>
            <span class="nx">res_model</span><span class="o">:</span> <span class="s1">'product.product'</span><span class="p">,</span>
            <span class="nx">res_id</span><span class="o">:</span> <span class="nx">$</span><span class="p">(</span><span class="nx">event</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">).</span><span class="nx">data</span><span class="p">(</span><span class="s1">'id'</span><span class="p">),</span>
            <span class="nx">views</span><span class="o">:</span> <span class="p">[[</span><span class="kc">false</span><span class="p">,</span> <span class="s1">'form'</span><span class="p">]],</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"PetToy"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_petstore_pettoy"</span> <span class="na">t-att-data-id=</span><span class="s">"item.id"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;p&gt;&lt;t</span> <span class="na">t-esc=</span><span class="s">"item.name"</span><span class="nt">/&gt;&lt;/p&gt;</span>
        <span class="nt">&lt;p&gt;&lt;img</span> <span class="na">t-attf-src=</span><span class="s">"data:image/jpg;base64,{{item.image}}"</span><span class="nt">/&gt;&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
</div></section><section id="client-actions"><h3 class="o_has_permalink_marker">Client Actions<i class="mdi-content-link"></i></h3><p>Throughout this guide, we used a simple <code>HomePage</code> widget which the web
client automatically starts when we select the right menu item. But how did
the Odoo web know to start this widget? Because the widget is registered as
a <em>client action</em>.</p><p>A client action is (as its name implies) an action type defined almost
entirely in the client, in javascript for Odoo web. The server simply sends
an action tag (an arbitrary name), and optionally adds a few parameters, but
beyond that <em>everything</em> is handled by custom client code.</p><p>Our widget is registered as the handler for the client action through this:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">client_actions</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'petstore.homepage'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.HomePage'</span><span class="p">);</span>
</pre></div>
</div>
<p><code>instance.web.client_actions</code> is a <code class="xref js js-class">Registry()</code> in which
the action manager looks up client action handlers when it needs to execute
one. The first parameter of <code class="xref js js-class">add()</code> is the name
(tag) of the client action, and the second parameter is the path to the widget
from the Odoo web client root.</p><p>When a client action must be executed, the action manager looks up its tag
in the registry, walks the specified path and displays the widget it finds at
the end.</p><div role="alert" class="alert alert-info"><h3 class="alert-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></h3><p>a client action handler can also be a regular function, in whch case
it’ll be called and its result (if any) will be interpreted as the
next action to execute.</p></div><p>On the server side, we had simply defined an <code>ir.actions.client</code> action:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;record</span> <span class="na">id=</span><span class="s">"action_home_page"</span> <span class="na">model=</span><span class="s">"ir.actions.client"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">"tag"</span><span class="nt">&gt;</span>petstore.homepage<span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<p>and a menu opening the action:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;menuitem</span> <span class="na">id=</span><span class="s">"home_page_petstore_menu"</span> <span class="na">parent=</span><span class="s">"petstore_menu"</span>
          <span class="na">name=</span><span class="s">"Home Page"</span> <span class="na">action=</span><span class="s">"action_home_page"</span><span class="nt">/&gt;</span>
</pre></div>
</div>
</section><section id="architecture-of-the-views"><h3 class="o_has_permalink_marker">Architecture of the Views<i class="mdi-content-link"></i></h3><p>Much of Odoo web’s usefulness (and complexity) resides in views. Each view
type is a way of displaying a model in the client.</p></section><section id="the-view-manager"><h4 class="o_has_permalink_marker">The View Manager<i class="mdi-content-link"></i></h4><p>When an <code>ActionManager</code> instance receive an action of type
<code>ir.actions.act_window</code>, it delegates the synchronization and handling of
the views themselves to a <em>view manager</em>, which will then set up one or
multiple views depending on the original action’s requirements:</p><a href="./自定义Web客户端 - odoo 12.0文档_files/viewarchitecture.svg" class="reference internal"><img src="./自定义Web客户端 - odoo 12.0文档_files/viewarchitecture.svg" class="img-responsive center-block"></a></section><section id="the-views"><h4 class="o_has_permalink_marker">The Views<i class="mdi-content-link"></i></h4><p>Most <a href="https://www.odoo.com/documentation/master/reference/views.html#reference-views" class="reference internal"><span class="std-ref std">Odoo views</span></a> are implemented through a subclass
of <code class="xref js js-class">odoo.web.View()</code> which provides a bit of generic basic structure
for handling events and displaying model information.</p><p>The <em>search view</em> is considered a view type by the main Odoo framework, but
handled separately by the web client (as it’s a more permanent fixture and
can interact with other views, which regular views don’t do).</p><p>A view is responsible for loading its own description XML (using
<a href="https://www.odoo.com/documentation/master/reference/orm.html#odoo.models.Model.fields_view_get" title="odoo.models.Model.fields_view_get" class="reference internal"><code class="py-class xref py">fields_view_get</code></a>) and any other data source
it needs. To that purpose, views are provided with an optional view
identifier set as the <code class="xref js-attr js">view_id</code> attribute.</p><p>Views are also provided with a <code class="xref js js-class">DataSet()</code> instance which
holds most necessary model information (the model name and possibly various
record ids).</p><p>Views may also want to handle search queries by overriding
<code class="xref js-func js">do_search()</code>, and updating their
<code class="xref js js-class">DataSet()</code> as necessary.</p></section><section id="the-form-view-fields"><h3 class="o_has_permalink_marker">The Form View Fields<i class="mdi-content-link"></i></h3><p>A common need is the extension of the web form view to add new ways of
displaying fields.</p><p>All built-in fields have a default display implementation, a new
form widget may be necessary to correctly interact with a new field type
(e.g. a <a href="https://www.odoo.com/documentation/master/glossary.html#term-gis" class="reference internal"><span class="xref std-term std">GIS</span></a> field) or to provide new representations and ways to
interact with existing field types (e.g. validate
<a href="https://www.odoo.com/documentation/master/reference/orm.html#odoo.fields.Char" title="odoo.fields.Char" class="reference internal"><code class="py-class xref py">Char</code></a> fields which should contain email addresses
and display them as email links).</p><p>To explicitly specify which form widget should be used to display a field,
simply use the <code>widget</code> attribute in the view’s XML description:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">"contact_mail"</span> <span class="na">widget=</span><span class="s">"email"</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<div role="alert" class="alert alert-info"><h3 class="alert-title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">注意</font></font></h3><ul><li>the same widget is used in both “view” (read-only) and “edition” modes
of a form view, it’s not possible to use a widget in one and an other
widget in the other</li><li>and a given field (name) can not be used multiple times in the same form</li><li>a widget may ignore the current mode of the form view and remain the
same in both view and edition</li></ul></div><p>Fields are instantiated by the form view after it has read its XML description
and constructed the corresponding HTML representing that description. After
that, the form view will communicate with the field objects using some
methods. These methods are defined by the <code>FieldInterface</code>
interface. Almost all fields inherit the <code>AbstractField</code> abstract
class. That class defines some default mechanisms that need to be implemented
by most fields.</p><p>Here are some of the responsibilities of a field class:</p><ul><li>The field class must display and allow the user to edit the value of the field.</li><li><p>It must correctly implement the 3 field attributes available in all fields
of Odoo. The <code>AbstractField</code> class already implements an algorithm that
dynamically calculates the value of these attributes (they can change at any
moment because their value change according to the value of other
fields). Their values are stored in <em>Widget Properties</em> (the widget
properties were explained earlier in this guide). It is the responsibility
of each field class to check these widget properties and dynamically adapt
depending of their values. Here is a description of each of these
attributes:</p><ul><li><code>required</code>: The field must have a value before saving. If <code>required</code>
is <code>true</code> and the field doesn’t have a value, the method
<code>is_valid()</code> of the field must return <code>false</code>.</li><li><code>invisible</code>: When this is <code>true</code>, the field must be invisible. The
<code>AbstractField</code> class already has a basic implementation of this
behavior that fits most fields.</li><li><code>readonly</code>: When <code>true</code>, the field must not be editable by the
user. Most fields in Odoo have a completely different behavior depending
on the value of <code>readonly</code>. As example, the <code>FieldChar</code> displays an
HTML <code>&lt;input&gt;</code> when it is editable and simply displays the text when
it is read-only. This also means it has much more code it would need to
implement only one behavior, but this is necessary to ensure a good user
experience.</li></ul></li><li>Fields have two methods, <code>set_value()</code> and <code>get_value()</code>, which are
called by the form view to give it the value to display and get back the new
value entered by the user. These methods must be able to handle the value as
given by the Odoo server when a <code>read()</code> is performed on a model and give
back a valid value for a <code>write()</code>.  Remember that the JavaScript/Python
data types used to represent the values given by <code>read()</code> and given to
<code>write()</code> is not necessarily the same in Odoo. As example, when you read a
many2one, it is always a tuple whose first value is the id of the pointed
record and the second one is the name get (ie: <code>(15, "Agrolait")</code>). But
when you write a many2one it must be a single integer, not a tuple
anymore. <code>AbstractField</code> has a default implementation of these methods
that works well for simple data type and set a widget property named
<code>value</code>.</li></ul><p>Please note that, to better understand how to implement fields, you are
strongly encouraged to look at the definition of the <code>FieldInterface</code>
interface and the <code>AbstractField</code> class directly in the code of the Odoo web
client.</p></section><section id="creating-a-new-type-of-field"><h4 class="o_has_permalink_marker">Creating a New Type of Field<i class="mdi-content-link"></i></h4><p>In this part we will explain how to create a new type of field. The example
here will be to re-implement the <code>FieldChar</code> class and progressively explain
each part.</p></section><section id="simple-read-only-field"><h5 class="o_has_permalink_marker">Simple Read-Only Field<i class="mdi-content-link"></i></h5><p>Here is a first implementation that will only display text. The
user will not be able to modify the content of the field.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">FieldChar2</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">AbstractField</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">"value"</span><span class="p">,</span> <span class="s2">""</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">render_value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"value"</span><span class="p">));</span>
    <span class="p">},</span>
<span class="p">});</span><font></font>
<font></font>
<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'char2'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.FieldChar2'</span><span class="p">);</span>
</pre></div>
</div>
<p>In this example, we declare a class named <code>FieldChar2</code> inheriting from
<code>AbstractField</code>. We also register this class in the registry
<code>instance.web.form.widgets</code> under the key <code>char2</code>. That will allow us to
use this new field in any form view by specifying <code>widget="char2"</code> in the
<code>&lt;field/&gt;</code> tag in the XML declaration of the view.</p><p>In this example, we define a single method: <code>render_value()</code>. All it does is
display the widget property <code>value</code>.  Those are two tools defined by the
<code>AbstractField</code> class. As explained before, the form view will call the
method <code>set_value()</code> of the field to set the value to display. This method
already has a default implementation in <code>AbstractField</code> which simply sets
the widget property <code>value</code>. <code>AbstractField</code> also watch the
<code>change:value</code> event on itself and calls the <code>render_value()</code> when it
occurs. So, <code>render_value()</code> is a convenience method to implement in child
classes to perform some operation each time the value of the field changes.</p><p>In the <code>init()</code> method, we also define the default value of the field if
none is specified by the form view (here we assume the default value of a
<code>char</code> field should be an empty string).</p></section><section id="read-write-field"><h5 class="o_has_permalink_marker">Read-Write Field<i class="mdi-content-link"></i></h5><p>Read-only fields, which only display content and don’t allow the
user to modify it can be useful, but most fields in Odoo also allow editing.
This makes the field classes more complicated, mostly because fields are
supposed to handle both editable and non-editable mode, those modes are
often completely different (for design and usability purpose) and the fields
must be able to switch between modes at any moment.</p><p>To know in which mode the current field should be, the <code>AbstractField</code> class
sets a widget property named <code>effective_readonly</code>. The field should watch
for changes in that widget property and display the correct mode
accordingly. Example:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">FieldChar2</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">AbstractField</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">"value"</span><span class="p">,</span> <span class="s2">""</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"change:effective_readonly"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">render_value</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_field</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">self</span> <span class="o">=</span> <span class="k">this</span><span class="p">;</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">"FieldChar2"</span><span class="p">,</span> <span class="p">{</span><span class="nx">widget</span><span class="o">:</span> <span class="k">this</span><span class="p">}));</span>
        <span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"effective_readonly"</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">"input"</span><span class="p">).</span><span class="nx">change</span><span class="p">(</span><span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
                <span class="nx">self</span><span class="p">.</span><span class="nx">internal_set_value</span><span class="p">(</span><span class="nx">self</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">"input"</span><span class="p">).</span><span class="nx">val</span><span class="p">());</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">render_value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"effective_readonly"</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"value"</span><span class="p">));</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">"input"</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"value"</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">});</span><font></font>
<font></font>
<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'char2'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.FieldChar2'</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"FieldChar2"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_field_char2"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">"! widget.get('effective_readonly')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"text"</span><span class="nt">&gt;&lt;/input&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<p>In the <code>start()</code> method (which is called immediately after a widget has been
appended to the DOM), we bind on the event <code>change:effective_readonly</code>. That
allows us to redisplay the field each time the widget property
<code>effective_readonly</code> changes. This event handler will call
<code>display_field()</code>, which is also called directly in <code>start()</code>. This
<code>display_field()</code> was created specifically for this field, it’s not a method
defined in <code>AbstractField</code> or any other class. We can use this method
to display the content of the field depending on the current mode.</p><p>From now on the conception of this field is typical, except there is a
lot of verifications to know the state of the <code>effective_readonly</code> property:</p><ul><li>In the QWeb template used to display the content of the widget, it displays
an <code>&lt;input type="text" /&gt;</code> if we are in read-write mode and nothing in
particular in read-only mode.</li><li>In the <code>display_field()</code> method, we have to bind on the <code>change</code> event
of the <code>&lt;input type="text" /&gt;</code> to know when the user has changed the
value. When it happens, we call the <code>internal_set_value()</code> method with the
new value of the field. This is a convenience method provided by the
<code>AbstractField</code> class. That method will set a new value in the <code>value</code>
property but will not trigger a call to <code>render_value()</code> (which is not
necessary since the <code>&lt;input type="text" /&gt;</code> already contains the correct
value).</li><li>In <code>render_value()</code>, we use a completely different code to display the
value of the field depending if we are in read-only or in read-write mode.</li></ul><div role="alert" class="alert alert-exercise"><h3 class="alert-title">Exercise</h3><p>Create a Color Field</p><p>Create a <code>FieldColor</code> class. The value of this field should be a string
containing a color code like those used in CSS (example: <code>#FF0000</code> for
red). In read-only mode, this color field should display a little block
whose color corresponds to the value of the field. In read-write mode, you
should display an <code>&lt;input type="color" /&gt;</code>. That type of <code>&lt;input /&gt;</code>
is an HTML5 component that doesn’t work in all browsers but works well in
Google Chrome. So it’s OK to use as an exercise.</p><p>You can use that widget in the form view of the <code>message_of_the_day</code>
model for its field named <code>color</code>. As a bonus, you can change the
<code>MessageOfTheDay</code> widget created in the previous part of this guide to
display the message of the day with the background color indicated in the
<code>color</code> field.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">FieldColor</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">AbstractField</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">'change input'</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">'effective_readonly'</span><span class="p">))</span> <span class="p">{</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">internal_set_value</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">e</span><span class="p">.</span><span class="nx">currentTarget</span><span class="p">).</span><span class="nx">val</span><span class="p">());</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">init</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">.</span><span class="nx">apply</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="nx">arguments</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s2">"value"</span><span class="p">,</span> <span class="s2">""</span><span class="p">);</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"change:effective_readonly"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">render_value</span><span class="p">();</span>
        <span class="p">});</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_field</span><span class="p">();</span>
        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_field</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">"FieldColor"</span><span class="p">,</span> <span class="p">{</span><span class="nx">widget</span><span class="o">:</span> <span class="k">this</span><span class="p">}));</span>
    <span class="p">},</span>
    <span class="nx">render_value</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"effective_readonly"</span><span class="p">))</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">".oe_field_color_content"</span><span class="p">).</span><span class="nx">css</span><span class="p">(</span><span class="s2">"background-color"</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"value"</span><span class="p">)</span> <span class="o">||</span> <span class="s2">"#FFFFFF"</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">"input"</span><span class="p">).</span><span class="nx">val</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"value"</span><span class="p">)</span> <span class="o">||</span> <span class="s2">"#FFFFFF"</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">},</span>
<span class="p">});</span>
<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'color'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.FieldColor'</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"FieldColor"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_field_color"</span><span class="nt">&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">"widget.get('effective_readonly')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;div</span> <span class="na">class=</span><span class="s">"oe_field_color_content"</span> <span class="nt">/&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
        <span class="nt">&lt;t</span> <span class="na">t-if=</span><span class="s">"! widget.get('effective_readonly')"</span><span class="nt">&gt;</span>
            <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">"color"</span><span class="nt">&gt;&lt;/input&gt;</span>
        <span class="nt">&lt;/t&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
<div class="highlight-css"><div class="highlight"><pre><span class="nc">.oe_field_color_content</span> <span class="p">{</span>
    <span class="nb">height</span><span class="o">:</span> <span class="m">20px</span><span class="p">;</span>
    <span class="nb">width</span><span class="o">:</span> <span class="m">50px</span><span class="p">;</span>
    <span class="nb">border</span><span class="o">:</span> <span class="m">1px</span> <span class="nb">solid</span> <span class="nb">black</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></section><section id="the-form-view-custom-widgets"><h3 class="o_has_permalink_marker">The Form View Custom Widgets<i class="mdi-content-link"></i></h3><p>Form fields are used to edit a single field, and are intrinsically linked to
a field. Because this may be limiting, it is also possible to create
<em>form widgets</em> which are not so restricted and have less ties to a specific
lifecycle.</p><p>Custom form widgets can be added to a form view through the <code>widget</code> tag:</p><div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;widget</span> <span class="na">type=</span><span class="s">"xxx"</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p>This type of widget will simply be created by the form view during the
creation of the HTML according to the XML definition. They have properties in
common with the fields (like the <code>effective_readonly</code> property) but they are
not assigned a precise field. And so they don’t have methods like
<code>get_value()</code> and <code>set_value()</code>. They must inherit from the <code>FormWidget</code>
abstract class.</p><p>Form widgets can interact with form fields by listening for their changes and
fetching or altering their values. They can access form fields through
their <code class="xref js-attr js">field_manager</code> attribute:</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">WidgetMultiplication</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">FormWidget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"field_changed:integer_a"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_result</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"field_changed:integer_b"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_result</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_result</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_result</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">"integer_a"</span><span class="p">)</span> <span class="o">*</span>
                     <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">"integer_b"</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">text</span><span class="p">(</span><span class="s2">"a*b = "</span> <span class="o">+</span> <span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span><font></font>
<font></font>
<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">custom_widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'multiplication'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.WidgetMultiplication'</span><span class="p">);</span>
</pre></div>
</div>
<p><code class="xref js-attr js">FormWidget</code> is generally the
<code class="xref js js-class">FormView()</code> itself, but features used from it should
be limited to those defined by <code class="xref js js-class">FieldManagerMixin()</code>,
the most useful being:</p><ul><li><code class="xref js-func js">get_field_value(field_name)()</code>
which returns the value of a field.</li><li><code class="xref js-func js">set_values(values)()</code> sets multiple
field values, takes a mapping of <code>{field_name: value_to_set}</code></li><li>An event <code class="samp">field_changed:<em>field_name</em></code> is triggered any time the value
of the field called <code>field_name</code> is changed</li></ul><div role="alert" class="alert alert-exercise"><h3 class="alert-title">Exercise</h3><p>Show Coordinates on Google Map</p><p>Add two fields to <code>product.product</code> storing a latitude and a longitude,
then create a new form widget to display the latitude and longitude of
a product’s origin on a map</p><p>To display the map, use Google Map’s embedding:</p><div class="highlight-html"><div class="highlight"><pre><span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">width</span><span class="o">=</span><span class="s">"400"</span> <span class="na">height</span><span class="o">=</span><span class="s">"300"</span> <span class="na">src</span><span class="o">=</span><span class="s">"https://maps.google.com/?ie=UTF8&amp;amp;ll=XXX,YYY&amp;amp;output=embed"</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>where <code>XXX</code> should be replaced by the latitude and <code>YYY</code> by the
longitude.</p><p>Display the two position fields and a map widget using them in a new
notebook page of the product’s form view.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">WidgetCoordinates</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">FormWidget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"field_changed:provider_latitude"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"field_changed:provider_longitude"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">();</span>
    <span class="p">},</span>
    <span class="nx">display_map</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">"WidgetCoordinates"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"latitude"</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">"provider_latitude"</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">"longitude"</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">"provider_longitude"</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
        <span class="p">}));</span>
    <span class="p">}</span>
<span class="p">});</span><font></font>
<font></font>
<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">custom_widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'coordinates'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.WidgetCoordinates'</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"WidgetCoordinates"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;iframe</span> <span class="na">width=</span><span class="s">"400"</span> <span class="na">height=</span><span class="s">"300"</span>
        <span class="na">t-attf-src=</span><span class="s">"https://maps.google.com/?ie=UTF8&amp;amp;ll={{latitude}},{{longitude}}&amp;amp;output=embed"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/iframe&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
</div><div role="alert" class="alert alert-exercise"><h3 class="alert-title">Exercise</h3><p>Get the Current Coordinate</p><p>Add a button resetting the product’s coordinates to the location of the
user, you can get these coordinates using the
<a href="http://diveintohtml5.info/geolocation.html" class="reference external alert-link">javascript geolocation API</a>.</p><p>Now we would like to display an additional button to automatically set the
coordinates to the location of the current user.</p><p>To get the coordinates of the user, an easy way is to use the geolocation
JavaScript API.  <a href="http://www.w3schools.com/html/html5_geolocation.asp" class="reference external alert-link">See the online documentation to know how to use it</a>.</p><p>Please also note that the user should not be able to
click on that button when the form view is in read-only mode. So, this
custom widget should handle correctly the <code>effective_readonly</code> property
just like any field. One way to do this would be to make the button
disappear when <code>effective_readonly</code> is true.</p><div class="highlight-javascript"><div class="highlight"><pre><span class="nx">local</span><span class="p">.</span><span class="nx">WidgetCoordinates</span> <span class="o">=</span> <span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">FormWidget</span><span class="p">.</span><span class="nx">extend</span><span class="p">({</span>
    <span class="nx">events</span><span class="o">:</span> <span class="p">{</span>
        <span class="s1">'click button'</span><span class="o">:</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
            <span class="nx">navigator</span><span class="p">.</span><span class="nx">geolocation</span><span class="p">.</span><span class="nx">getCurrentPosition</span><span class="p">(</span>
                <span class="k">this</span><span class="p">.</span><span class="nx">proxy</span><span class="p">(</span><span class="s1">'received_position'</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nx">start</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="kd">var</span> <span class="nx">sup</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">_super</span><span class="p">();</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"field_changed:provider_latitude"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"field_changed:provider_longitude"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s2">"change:effective_readonly"</span><span class="p">,</span> <span class="k">this</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">);</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">display_map</span><span class="p">();</span>
        <span class="k">return</span> <span class="nx">sup</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">display_map</span><span class="o">:</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$el</span><span class="p">.</span><span class="nx">html</span><span class="p">(</span><span class="nx">QWeb</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="s2">"WidgetCoordinates"</span><span class="p">,</span> <span class="p">{</span>
            <span class="s2">"latitude"</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">"provider_latitude"</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">"longitude"</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">get_field_value</span><span class="p">(</span><span class="s2">"provider_longitude"</span><span class="p">)</span> <span class="o">||</span> <span class="mi">0</span><span class="p">,</span>
        <span class="p">}));</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">$</span><span class="p">(</span><span class="s2">"button"</span><span class="p">).</span><span class="nx">toggle</span><span class="p">(</span><span class="o">!</span> <span class="k">this</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s2">"effective_readonly"</span><span class="p">));</span>
    <span class="p">},</span>
    <span class="nx">received_position</span><span class="o">:</span> <span class="kd">function</span><span class="p">(</span><span class="nx">obj</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="nx">field_manager</span><span class="p">.</span><span class="nx">set_values</span><span class="p">({</span>
            <span class="s2">"provider_latitude"</span><span class="o">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">latitude</span><span class="p">,</span>
            <span class="s2">"provider_longitude"</span><span class="o">:</span> <span class="nx">obj</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">longitude</span><span class="p">,</span>
        <span class="p">});</span>
    <span class="p">},</span>
<span class="p">});</span><font></font>
<font></font>
<span class="nx">instance</span><span class="p">.</span><span class="nx">web</span><span class="p">.</span><span class="nx">form</span><span class="p">.</span><span class="nx">custom_widgets</span><span class="p">.</span><span class="nx">add</span><span class="p">(</span><span class="s1">'coordinates'</span><span class="p">,</span> <span class="s1">'instance.oepetstore.WidgetCoordinates'</span><span class="p">);</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;t</span> <span class="na">t-name=</span><span class="s">"WidgetCoordinates"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;iframe</span> <span class="na">width=</span><span class="s">"400"</span> <span class="na">height=</span><span class="s">"300"</span>
        <span class="na">t-attf-src=</span><span class="s">"https://maps.google.com/?ie=UTF8&amp;amp;ll={{latitude}},{{longitude}}&amp;amp;output=embed"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;/iframe&gt;</span>
    <span class="nt">&lt;button&gt;</span>Get My Current Coordinate<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/t&gt;</span>
</pre></div>
</div>
</div><div id="id4" class="footnote"><span class="footnote-label"><a class="footnote-backref" href="https://www.odoo.com/documentation/master/howtos/web.html#id1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[1]</font></font></a></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">作为与实例分开的概念。</font><font style="vertical-align: inherit;">在许多语言中，类是完整的对象和它们自己的实例（元类）但在类和实例之间仍然存在两个相当独立的层次结构</font></font></div><div id="dombugs" class="footnote"><span class="footnote-label"><a class="footnote-backref" href="https://www.odoo.com/documentation/master/howtos/web.html#id2"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">[2]</font></font></a></span><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">以及关于跨浏览器差异的论文，尽管随着时间的推移这已变得不那么必要了</font></font></div></section>

          </article>
        </div>
        
        <div id="mask"></div>
      </main>
  </div>

  <div class="floating_action_container">
    <a id="floating_action" class="ripple" href="https://www.odoo.com/documentation/master/howtos/web.html#" style="position: relative; overflow: hidden;">
      <i class="mdi-action-explore"></i>
    </a>
    <div id="floating_action_menu">
      <span class="bubble"></span>
      <ul class="list-group content"><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#a-simple-module" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">一个简单的模块</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#odoo-javascript-module" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Odoo JavaScript模块</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#classes" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#widgets-basics" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小部件基础知识</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#the-qweb-template-engine" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">QWeb模板引擎</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#widget-helpers" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小工具助手</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#widget-events-and-properties" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">小部件事件和属性</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#modify-existing-widgets-and-classes" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">修改现有的小部件和类</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#translations" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻译</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#communication-with-the-odoo-server" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">与Odoo服务器通信</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#exercises" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">演习</font></font></a></li><li class="list-group-item ripple" style="position: relative; overflow: hidden;"><a href="https://www.odoo.com/documentation/master/howtos/web.html#existing-web-components" class="reference internal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">现有的Web组件</font></font></a></li></ul>
    </div>
  </div>
  <footer class="o_footer_effect">
    <div id="footer" class="container">
      <span class="o_logo o_logo_inverse center-block o_footer_logo"></span>
      <div class="row">
        <div class="col-sm-7 col-md-7 col-lg-6">
          <div class="row">
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">社区</font></font></span>
              <ul>
                <li><a href="https://github.com/odoo/odoo"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Github上</font></font></a></li>
                <li><a href="http://www.odoo.com/page/download"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">下载</font></font></a></li>
                <li class="divider"></li>
                <li><a href="http://runbot.odoo.com/runbot/repo/git-github-com-odoo-enterprise-7"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Runbot</font></font></a></li>
                <li><a href="https://github.com/odoo/odoo/wiki/Translations"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">翻译</font></font></a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/odoo-community"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">邮件列表</font></font></a></li>
                <li><a href="http://www.odoo.com/forum/help-1"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">论坛</font></font></a></li>
              </ul>
            </div>
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">服务</font></font></span>
              <ul>
                <li><a href="https://www.odoo.sh/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">Odoo云平台</font></font></a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/help"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">支持</font></font></a></li>
                <li><a href="https://upgrade.odoo.com/"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">升级</font></font></a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/partners"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">寻找合作伙伴</font></font></a></li>
                <li><a href="http://www.odoo.com/page/become-a-partner"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">成为一个合伙人（参与者</font></font></a></li>
                <li class="divider"></li>
                <li><a href="http://training.odoo.com/courses/odoo-functional"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">培训中心</font></font></a></li>
                <li><a href="http://www.odoo.com/page/education-program"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">教育</font></font></a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/security"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">安全</font></font></a></li>
              </ul>
            </div>
            <div class="col-xs-12 col-sm-4 mb64">
              <span class="menu_title"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">关于我们</font></font></span>
              <ul>
                <li><a href="http://www.odoo.com/page/about-us"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">我们公司</font></font></a></li>
                <li><a href="http://www.odoo.com/page/contactus"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">联系</font></font></a></li>
                <li class="divider">
                </li><li><a href="http://www.odoo.com/event"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">活动</font></font></a></li>
                <li><a href="http://www.odoo.com/blog"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">博客</font></font></a></li>
                <li><a href="http://www.odoo.com/blog/6"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">顾客</font></font></a></li>
                <li class="divider">
                </li><li><a href="http://www.odoo.com/jobs"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">工作</font></font></a></li>
                <li class="divider">
                </li><li><a href="http://www.odoo.com/page/legal"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">法律</font></font></a><font style="vertical-align: inherit;"><font style="vertical-align: inherit;"> | </font></font><a href="http://www.odoo.com/privacy"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">隐私</font></font></a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-sm-5 col-md-4 col-md-offset-1 col-lg-5 col-lg-offset-1">
          <p>
            <small><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              Odoo是一套开源商业应用程序，可满足您公司的所有需求：CRM，电子商务，会计，库存，销售点，项目管理等
               </font></font><br><br><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">
              .Odoo独特的价值主张同时也非常易于使用和完全集成。
            </font></font></small>
          </p>
        </div>
      </div>
    </div>
    <div class="o_footer_bottom">
      <div class="container">
        <a class="small" href="http://www.odoo.com/page/website-builder"><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">网站制作 </font></font><span class="o_logo o_logo_inverse o_logo_15"></span></a>
        <div class="social-links pull-right">
          <a href="http://www.odoo.com/web/about/facebook"><i class="fa fa-facebook"></i></a>
          <a href="http://www.odoo.com/web/about/twitter"><i class="fa fa-twitter"></i></a>
          <a href="http://www.odoo.com/web/about/linkedin"><i class="fa fa-linkedin"></i></a>
          <a href="mailto:info@odoo.com"><i class="fa fa-envelope"></i></a>
        </div>
      </div>
    </div>
  </footer><script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-52174891-1', 'auto');
    ga('send','pageview');
    </script><div id="goog-gt-tt" class="skiptranslate" dir="ltr"><div style="padding: 8px;"><div><div class="logo"><img src="./自定义Web客户端 - odoo 12.0文档_files/translate_24dp.png" width="20" height="20" alt="Google 翻译"></div></div></div><div class="top" style="padding: 8px; float: left; width: 100%;"><h1 class="title gray">原文</h1></div><div class="middle" style="padding: 8px;"><div class="original-text"></div></div><div class="bottom" style="padding: 8px;"><div class="activity-links"><span class="activity-link">提供更好的翻译建议</span><span class="activity-link"></span></div><div class="started-activity-container"><hr style="color: #CCC; background-color: #CCC; height: 1px; border: none;"><div class="activity-root"></div></div></div><div class="status-message" style="display: none;"></div></div>
  
<div class="goog-te-spinner-pos"><div class="goog-te-spinner-animation"><svg xmlns="http://www.w3.org/2000/svg" class="goog-te-spinner" width="96px" height="96px" viewBox="0 0 66 66"><circle class="goog-te-spinner-path" fill="none" stroke-width="6" stroke-linecap="round" cx="33" cy="33" r="30"></circle></svg></div></div></body></html>